/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/js/B2C-02-detalhe-produto.dev.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/js/B2C-02-detalhe-produto.dev.js":
/*!**********************************************!*\
  !*** ./src/js/B2C-02-detalhe-produto.dev.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("$(function () {//\r\n\tlet acessorio = document.querySelector(\".mz-accesories__button--buy\");\r\n\r\n\tif (acessorio) {\r\n\t\t$(\".product-qd-v1-standard .buy-button\").addClass(\"secondary\");\r\n\t}\r\n\r\n\tlet skuList = Product.captureSkuSelectors();\r\n\tvar urlCart =\r\n\t\t\"/checkout/cart/add?sku=\" +\r\n\t\tskuList[0] +\r\n\t\t\"&qty=1&seller=1&redirect=true&sc=1\";\r\n\t$(\".mz-pickup__button--buy\").attr(\"href\", urlCart);\r\n\t$(\".mz-pickup__button--buy\").removeClass(\"lock-button\"); //lock-button\r\n\r\n\t$(\".link.lojas\").click(function (e) {\r\n\t\te.preventDefault();\r\n\t\t$(document.body).addClass(\"mz-pu-on\");\r\n\t\t$(document.body).addClass(\"mz-bo-on\");\r\n\t});\r\n\t$(\".mz-pickup__close--button,.mz-modal-overlay\").click(function () {\r\n\t\t$(document.body).removeClass(\"mz-in-on mz-as-on mz-bo-on mz-pu-on\");\r\n\t});\r\n\r\n\tga('create', 'UA-133498560-1', 'autoglassonline.com');\r\n\tif ($(\".product-qd-v1-price\").is(\":empty\")) {\r\n\t\t/*\r\n\t\t\tSe o produto está indisponível, oculta boxes de preço e entrega\r\n\t\t*/\r\n\t\t$(\r\n\t\t\t\".product-qd-v1-standard.row .header, .product-qd-v1-sku-selection, .product-qd-v1-price, .product-qd-v1-shipping\"\r\n\t\t).hide();\r\n\r\n\t\t//Exibe o botão para o cliente conversar com o vendedor pelo Chat\r\n\t\t$('.product-unavailable')\r\n\t\t\t.on('click', (e) => {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tconst today = new Date();\r\n\t\t\t\tconst hour = today.getHours();\r\n\t\t\t\tconst day = today.getDay();\r\n\r\n\t\t\t\tif ((day === 0 || day === 6) //É Domingo ou Sábado?\r\n\t\t\t\t\t|| (hour < 8 || hour >= 18) //Esta fora do horario de trabalho?\r\n\t\t\t\t) {\r\n\t\t\t\t\tzE('webWidget', 'chat:addTags', 'fora-expediente');\r\n\t\t\t\t\tzE('webWidget', 'chat:send', `Olá, nosso horário de atendimento é de Seg-Sex de 08-18h, no momento estamos sem consultor disponível. Por favor, informe seu Nome e Celular que entraremos em contato o mais breve possível. Produto para consulta: ${window.location.href}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tzE('webWidget', 'chat:send', `Olá, tenho interesse neste produto, mas está indisponível no site: ${window.location.href}`);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tzE('webWidget', 'open');\r\n\t\t\t});\r\n\r\n\t\t$('.talk-to-seller').show();\r\n\r\n\t\tif (!$(\"#similars\").is(\":empty\")) {\r\n\t\t\t$(\".other-brands\").show();\r\n\t\t\t$(\".other-brands button\").click(e => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tif ($(window).width() > 900) {\r\n\t\t\t\t\t$(\"html, body\").stop().animate({\r\n\t\t\t\t\t\tscrollTop: $(\"#similars\").offset().top - 300\r\n\t\t\t\t\t}, 900, \"swing\")\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"html, body\").stop().animate({\r\n\t\t\t\t\t\tscrollTop: $(\"#similars\").offset().top - 170\r\n\t\t\t\t\t}, 900, \"swing\")\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\".product-unavailable\").addClass(\"buy-button other-brands secondary\");\r\n\r\n\t\t\tlet modal = document.querySelector('#myModal');\r\n\r\n\t\t\tmodal.style.display = 'block';\r\n\r\n\t\t\tvtexjs.catalog.getCurrentProductWithVariations().done(function (product) {\r\n\t\t\t\twindow\r\n\t\t\t\t\t.location\r\n\t\t\t\t\t.replace(\r\n\t\t\t\t\t\t$(\"#similars .qd-product-is-in-stock-true a.shelf-qd-v1-stamps\")[0]\r\n\t\t\t\t\t\t\t.href\r\n\t\t\t\t\t\t+ '?utm_source=produtodisponivel&utm_medium=redirecionamento&utm_campaign='\r\n\t\t\t\t\t\t+ product.productId);\r\n\t\t\t});\r\n\r\n\r\n\t\t}\r\n\r\n\r\n\t\tga(\"send\", \"event\", \"estoque\", \"detalhe-produto\", \"indisponivel\");\r\n\t} else {\r\n\t\tga(\"send\", \"event\", \"estoque\", \"detalhe-produto\", \"disponivel\");\r\n\t}\r\n\r\n\t$('#instalar-na-loja-btn').click(e => localStorage.setItem('AG_SeletedChannel', 'pickup-in-point'));\r\n\t$('#retire-na-loja-btn').click(e => localStorage.setItem('AG_SeletedChannel', 'pickup-in-point'));\r\n\r\n\t$('#instalar-em-casa-btn').click(e => localStorage.setItem('AG_SeletedChannel', 'delivery'));\r\n\t$('#receba-em-casa-btn').click(e => localStorage.setItem('AG_SeletedChannel', 'delivery'));\r\n\r\n\t$('.store .time .time-list button').click(e => {\r\n\t\t$('.store .time .time-list button').removeClass('selected')\r\n\t\t$(this).addClass('selected');\r\n\t});\r\n\r\n\tsetTimeout(function () {\r\n\t\t$(\"#txtCep\").after('<span class=\"ttp\"></span>');\r\n\t}, 500);\r\n\r\n\t$('#similars h2').after(`<p class=\"descricao-rollout\">Confira opções de <strong>${vtxctx.categoryName.toLowerCase()\r\n\t\t}</strong> para este mesmo veículo ${$('.value-field.Compatibilidade-Modelo').length ? `(<strong>${$('.value-field.Compatibilidade-Modelo').html()\r\n\t\t\t}</strong>)` : $('.value-field.Veiculo').length ? `(<strong>${$('.value-field.Veiculo').html()\r\n\t\t\t\t}</strong>)` : ``}</p>`);\r\n\r\n\t$('#sugestoes h2').after(\r\n\t\t`<p class=\"descricao-rollout\">\r\n\t\t\tAproveite e confira outros produtos\r\n\t\t\t${$('.value-field.Compatibilidade-Modelo').length\r\n\t\t\t? ` para <strong>${$('.value-field.Compatibilidade-Modelo').html()}</strong>`\r\n\t\t\t: $('.value-field.Veiculo').length\r\n\t\t\t\t? ` para <strong>${$('.value-field.Veiculo').html()}</strong>`\r\n\t\t\t\t: ``\r\n\t\t}\r\n\t\t</p>`\r\n\t);\r\n\r\n\t$(window).load(() => {\r\n\t\tconst shippingsDiv = document.querySelector('.freight-values');\r\n\t\tconst observerShippingsDiv = new MutationObserver(() => {\r\n\t\t\tconst textCepInput = document.querySelector('#txtCep');\r\n\r\n\t\t\tconst gaFreight = [];\r\n\r\n\t\t\tconst freights = [...shippingsDiv.querySelectorAll('td')]\r\n\t\t\t\t.filter(x => !(x.innerText.includes('Frete Grátis') || x.innerText == \"\" || x.innerText.startsWith('R$')))\r\n\t\t\t\t.map(x => x.innerText);\r\n\r\n\t\t\tfreights.forEach(x => {\r\n\t\t\t\tconst freight = x.split(',')[0];\r\n\r\n\t\t\t\tif (freight.startsWith('Frete Retirada') && !gaFreight.includes('Retirada em Loja'))\r\n\t\t\t\t\tgaFreight.push('Retirada em Loja');\r\n\r\n\t\t\t\tif (freight.startsWith('Frete Autoglass Express'))\r\n\t\t\t\t\tgaFreight.push('Autoglass Express');\r\n\r\n\t\t\t\tif (freight.startsWith('Frete PAC'))\r\n\t\t\t\t\tgaFreight.push('PAC');\r\n\r\n\t\t\t\tif (freight.startsWith('Frete Sedex'))\r\n\t\t\t\t\tgaFreight.push('Sedex');\r\n\r\n\t\t\t\tif (freight.startsWith('Frete Transportadora'))\r\n\t\t\t\t\tgaFreight.push('Transportadora');\r\n\r\n\t\t\t\tif (freight.startsWith('Frete Normal'))\r\n\t\t\t\t\tgaFreight.push('Normal');\r\n\t\t\t});\r\n\r\n\t\t\tgaFreight.length > 0\r\n\t\t\t\t? ga('send', 'event', 'busca-ceps', 'encontrado', textCepInput.value + ',' + gaFreight.join(','))\r\n\t\t\t\t: ga('send', 'event', 'busca-ceps', 'nao-encontrado', textCepInput.value);\r\n\r\n\t\t});\r\n\r\n\t\tshippingsDiv && observerShippingsDiv.observe(shippingsDiv, { attributes: true, childList: true, subtree: true });\r\n\t});\r\n});\r\n\r\nfunction consulteFrete() {\r\n\tlet txtCep = document.getElementById(\"txtCep\");\r\n\ttxtCep.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\r\n\ttxtCep.focus();\r\n\tconsole.log(txtCep);\r\n}\r\n\r\n$(function LojasMaisProximas() {\r\n\tlet SLA = [];\r\n\r\n\tconst CONFIG = {\r\n\t\tSERVICE: {\r\n\t\t\tCOUNTRY: 'BRA',\r\n\t\t\tSKU_ID: vtxctx.skus\r\n\t\t},\r\n\t\tCSS: {\r\n\t\t\tBASE: '.mz-modal-pickup',\r\n\t\t\tMODAL_LIST: '.mz-pickup-stores__list ul'\r\n\t\t}\r\n\t}\r\n\r\n\tconst View = ViewAPI();\r\n\tconst Service = ServiceAPI();\r\n\tconst Controller = ControllerAPI();\r\n\r\n\tController._init();\r\n\r\n\tfunction ControllerAPI() {\r\n\t\treturn {\r\n\t\t\t_init,\r\n\t\t\tsimulateShipping\r\n\t\t}\r\n\r\n\t\tfunction _init() {\r\n\t\t\tconst address = JSON.parse(localStorage.getItem('AG_AddressSelected'));\r\n\r\n\t\t\tif (address) {\r\n\t\t\t\tsimulateShipping(address);\r\n\t\t\t} else {\r\n\t\t\t\t// Evento lançado pelo componente de cep\r\n\t\t\t\t$(window).on('cep-finish-load', e => {\r\n\t\t\t\t\tconst orderForm = e.originalEvent.detail;\r\n\t\t\t\t\tsimulateShipping(orderForm.shippingData.address);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Evento lançado pelo componente de cep\r\n\t\t\t$(window).on('cep-updated', e => {\r\n\t\t\t\tconst orderForm = e.originalEvent.detail;\r\n\t\t\t\tconsole.log(orderForm.shippingData.address)\r\n\t\t\t\tsimulateShipping(orderForm.shippingData.address);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tasync function simulateShipping(address) {\r\n\t\t\tif (address) {\r\n\t\t\t\tlet shippingData = await Service.simulateShipping(address);\r\n\r\n\t\t\t\tSLA = shippingData\r\n\t\t\t\t\t.logisticsInfo[0]\r\n\t\t\t\t\t.slas\r\n\t\t\t\t\t.filter(x => x.deliveryChannel === 'pickup-in-point');\r\n\r\n\t\t\t\tView.buildListStore(SLA);\r\n\t\t\t\tView.addClicks();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction ViewAPI() {\r\n\t\treturn {\r\n\t\t\tbuildListStore,\r\n\t\t\taddClicks\r\n\t\t}\r\n\r\n\t\tfunction buildListStore(pickups) {\r\n\t\t\tlet html = '';\r\n\r\n\t\t\tif (pickups.length) {\r\n\t\t\t\t$('.without-store').hide();\r\n\t\t\t\tpickups.forEach(({ id, shippingEstimate, pickupDistance, pickupStoreInfo }) => {\r\n\t\t\t\t\thtml += `\r\n\t\t\t\t\t\t<li id=\"${id}\" class=\"pickup\">\r\n\t\t\t\t\t\t\t<div class=\"pickup__info\">\r\n\t\t\t\t\t\t\t\t<div class=\"pickup__info-distance\">\r\n\t\t\t\t\t\t\t\t\t<svg class=\"pkpmodal-pickup-point-best-marker-image\" width=\"25\" height=\"32\" viewBox=\"0 0 25 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19.4917 22.3169L19.4918 22.3169L19.4967 22.3096C19.5843 22.1782 19.6709 22.0485 19.7564 21.9204C22.0478 18.4883 23.5645 16.2165 23.5645 12.5323C23.5645 6.16317 18.4013 1 12.0323 1C5.66317 1 0.5 6.16317 0.5 12.5323C0.5 16.5417 3.05396 20.5158 5.20313 23.2599C6.56216 24.9952 9.21424 28.1986 11.703 30.3763L12.0323 30.6644L12.3615 30.3763C14.8402 28.2075 16.7075 26.3386 19.4917 22.3169Z\" fill=\"#2D78F6\" stroke=\"white\"></path><path d=\"M18.6968 9.73418L14.6509 9.14642L12.8407 5.48019C12.5239 4.83994 11.4759 4.83994 11.159 5.48019L9.3498 9.14642L5.30298 9.73418C4.53711 9.84573 4.22682 10.7906 4.78365 11.3344L7.71213 14.1878L7.02126 18.2178C6.89096 18.9808 7.69338 19.5667 8.38145 19.2058L11.9999 17.3038L15.6192 19.2068C16.3017 19.5639 17.1107 18.9874 16.9794 18.2187L16.2885 14.1888L19.217 11.3353C19.7729 10.7906 19.4626 9.84573 18.6968 9.73418Z\" fill=\"white\"></path></svg>\r\n\t\t\t\t\t\t\t\t\t<p>${pickupDistance.toFixed(1)} km</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"pickup__info-address\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"address-title\">\r\n\t\t\t\t\t\t\t\t\t\t<b>${pickupStoreInfo.friendlyName}</b>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<p class=\"address-location\">\r\n\t\t\t\t\t\t\t\t\t\t${pickupStoreInfo.address.street} ${pickupStoreInfo.address.number},\r\n\t\t\t\t\t\t\t\t\t\t${pickupStoreInfo.address.complement}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t<p class=\"pickup__info-city\">${pickupStoreInfo.address.neighborhood} - ${pickupStoreInfo.address.city} - ${pickupStoreInfo.address.state}</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"pickup__estimate\">\r\n\t\t\t\t\t\t\t\t<span>Grátis</span>\r\n\t\t\t\t\t\t\t\t<span>Pronto em até ${Service.calculateTimeEstimate(shippingEstimate)}</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t`;\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\t$('.without-store').show();\r\n\t\t\t\thtml += '<span><a onclick=\"$zopim.livechat.window.show()\">Clique aqui</a> e fale com a gente pelo chat!</span>';\r\n\t\t\t}\r\n\r\n\t\t\t$(CONFIG.CSS.MODAL_LIST).html(html)\r\n\t\t}\r\n\r\n\t\tfunction addClicks() {\r\n\t\t\t$('.pickup').click(function () {\r\n\t\t\t\t$('.pickup').removeClass('selected');\r\n\t\t\t\t$(this).addClass('selected');\r\n\r\n\t\t\t\tService.saveSelectedPickupPoint($(this).attr('id'));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction ServiceAPI() {\r\n\t\treturn {\r\n\t\t\tsimulateShipping,\r\n\t\t\tcalculateTimeEstimate,\r\n\t\t\tsaveSelectedPickupPoint,\r\n\t\t\tsendCalculateShipping\r\n\t\t}\r\n\r\n\t\tfunction calculateTimeEstimate(estimate) {\r\n\t\t\tconst match = estimate.match(/\\d+/);\r\n\t\t\tconst days =  +match[0];\r\n\r\n\t\t\treturn days + (days > 0 ? ' dias úteis' : ' dia útil');\r\n\t\t}\r\n\r\n\t\tasync function simulateShipping(address) {\r\n\t\t\tconst request = {\r\n\t\t\t\titems: [{\r\n\t\t\t\t\tid: CONFIG.SERVICE.SKU_ID,\r\n\t\t\t\t\tquantity: 1,\r\n\t\t\t\t\tseller: 1\r\n\t\t\t\t}],\r\n\t\t\t\tpostalCode: address.postalCode,\r\n\t\t\t\tcountry: CONFIG.SERVICE.COUNTRY\r\n\t\t\t};\r\n\r\n\t\t\treturn $.ajax({\r\n\t\t\t\turl: \"/api/checkout/pub/orderForms/simulation\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\",\r\n\t\t\t\tcontentType: \"application/json\",\r\n\t\t\t\tdata: JSON.stringify(request)\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction saveSelectedPickupPoint(id) {\r\n\t\t\tconst sla = SLA.find(x => x.id === id);\r\n\r\n\t\t\tlocalStorage.setItem('AG_SeletedPickupPoint', JSON.stringify(sla));\r\n\t\t\tsendCalculateShipping(sla.pickupStoreInfo.address.postalCode, 'search');\r\n\t\t}\r\n\r\n\t\tfunction sendCalculateShipping(cep, type) {\r\n\t\t\t$('.mz-pickup__button--buy').click(e => e.preventDefault());\r\n\r\n\t\t\tvtexjs.checkout.calculateShipping({\r\n\t\t\t\tpostalCode: cep,\r\n\t\t\t\tcountry: 'BRA',\r\n\t\t\t\taddressType: type\r\n\t\t\t}).then(order => { forceChangeShipping(order); $('.mz-pickup__button--buy').unbind('click'); });\r\n\t\t}\r\n\r\n\t\tfunction forceChangeShipping(orderForm) {\r\n\t\t\tconst newSelectedAddresses = [orderForm.shippingData.availableAddresses[orderForm.shippingData.availableAddresses.length - 1]];\r\n\t\t\tconst logistic = orderForm.shippingData.logisticsInfo[0];\r\n\r\n\t\t\tif (logistic) {\r\n\t\t\t\tconst slas = logistic.slas.filter(x => x.deliveryChannel === 'pickup-in-point');\r\n\t\t\t\tconst logisticsInfo = orderForm.shippingData.logisticsInfo.map(x => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\taddressId: newSelectedAddresses[0].addressId,\r\n\t\t\t\t\t\titemIndex: x.itemIndex,\r\n\t\t\t\t\t\tselectedDeleveryChannel: 'pickup-in-point',\r\n\t\t\t\t\t\tselectedSla: slas[0].id\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tfetch(`/api/checkout/pub/orderForm/${orderForm.orderFormId}/attachments/shippingData`, {\r\n\t\t\t\t\tmethod: 'post',\r\n\t\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\t\tclearAddressIfPostalCodeNotFound: false,\r\n\t\t\t\t\t\texpectedOrderFormSections: ['shippingData'],\r\n\t\t\t\t\t\tselectedAddresses: newSelectedAddresses,\r\n\t\t\t\t\t\tlogisticsInfo\r\n\t\t\t\t\t})\r\n\t\t\t\t}).then(res => res.json()).then(x => {\r\n\t\t\t\t\tvtexjs.checkout.sendAttachment('shippingData', {\r\n\t\t\t\t\t\tselectedAddresses: newSelectedAddresses,\r\n\t\t\t\t\t\tlogisticsInfo\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n$(function CalculeOFrete() {\r\n\tlet SLA = [];\r\n\r\n\tconst CONFIG = {\r\n\t\tSERVICE: {\r\n\t\t\tCOUNTRY: 'BRA',\r\n\t\t\tSKU_ID: vtxctx.skus\r\n\t\t},\r\n\t\tCONTROLS: {\r\n\t\t\tIGNORE_DELIVERY: 'Autoglass Móvel',\r\n\t\t\tSELECTED: 'selected',\r\n\t\t},\r\n\t\tCSS: {\r\n\t\t\tOPEN: '.link.cep',\r\n\t\t\tMODAL: {\r\n\t\t\t\tBASE: 'mz-modal-shipping',\r\n\t\t\t\tBODY: 'mz-bo-on mz-sf-on',\r\n\t\t\t\tOVERLAY: '.mz-modal-overlay',\r\n\t\t\t\tCLOSE: '.mz-shipping__close--button',\r\n\t\t\t\tBUTTON: '.mz-shipping__button--buy',\r\n\t\t\t\tTITLE: {\r\n\t\t\t\t\tENABLE: '.mz-content__title--enable',\r\n\t\t\t\t\tEMPTY: '.mz-content__title--empty',\r\n\t\t\t\t},\r\n\t\t\t\tCONTENT: '.mz-shipping__content',\r\n\t\t\t\tLIST: '.mz-shipping__list ul',\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconst View = ViewAPI();\r\n\tconst Controller = ControllerAPI();\r\n\tconst Service = ServiceAPI();\r\n\r\n\tController._init();\r\n\r\n\tfunction ControllerAPI() {\r\n\t\treturn {\r\n\t\t\t_init,\r\n\t\t\tsearchDeliverys\r\n\t\t}\r\n\r\n\t\tfunction _init() {\r\n\t\t\tView._init();\r\n\r\n\t\t\tconst address = JSON.parse(localStorage.getItem('AG_AddressSelected'));\r\n\r\n\t\t\tif (address) {\r\n\t\t\t\tsearchDeliverys(address.postalCode);\r\n\t\t\t} else {\r\n\t\t\t\t// Evento lançado pelo componente de cep\r\n\t\t\t\t$(window).on('cep-finish-load', e => {\r\n\t\t\t\t\tconst orderForm = e.originalEvent.detail;\r\n\t\t\t\t\tsearchDeliverys(orderForm.shippingData.address.postalCode);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Evento lançado pelo componente de cep\r\n\t\t\t$(window).on('cep-updated', e => {\r\n\t\t\t\tconst orderForm = e.originalEvent.detail;\r\n\t\t\t\tsearchDeliverys(orderForm.shippingData.address.postalCode);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tasync function searchDeliverys(address) {\r\n\t\t\tconst { logisticsInfo } = await Service.simulateShipping({ postalCode: address });\r\n\r\n\t\t\tSLA = logisticsInfo[0].slas\r\n\t\t\t\t.filter(x => x.deliveryChannel === 'delivery');\r\n\r\n\t\t\tconst [cheapestOption, fastestOption] = SLA;\r\n\r\n\t\t\tlet cEstimate, fEstimate;\r\n\r\n\t\t\tif (fastestOption) {\r\n\t\t\t\tcEstimate = Service.getEstimateDays(cheapestOption.shippingEstimate);\r\n\t\t\t\tfEstimate = Service.getEstimateDays(fastestOption.shippingEstimate);\r\n\t\t\t}\r\n\r\n\t\t\tif (fastestOption && (fEstimate < cEstimate)) {\r\n\t\t\t\tfastestOption.name = 'Mais rápida';\r\n\t\t\t\tcheapestOption.name = 'Mais econômica';\r\n\r\n\t\t\t\tView.buildListDelivery([cheapestOption, fastestOption]);\r\n\t\t\t} else if (cheapestOption) {\r\n\t\t\t\tcheapestOption.name = 'Melhor opção';\r\n\t\t\t\tView.buildListDelivery([cheapestOption]);\r\n\t\t\t} else {\r\n\t\t\t\tView.buildListDelivery([]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction ViewAPI() {\r\n\t\treturn {\r\n\t\t\t_init,\r\n\t\t\tbuildListDelivery\r\n\t\t}\r\n\r\n\t\tfunction _init() {\r\n\t\t\t$(CONFIG.CSS.MODAL.CONTENT).hide();\r\n\t\t\taddClicks();\r\n\t\t}\r\n\r\n\t\tfunction addClicks() {\r\n\t\t\t$(CONFIG.CSS.OPEN).click(() => {\r\n\t\t\t\t$(document.body).addClass(CONFIG.CSS.MODAL.BODY);\r\n\t\t\t});\r\n\r\n\t\t\t$(CONFIG.CSS.MODAL.CLOSE).click(() => {\r\n\t\t\t\t$(document.body).removeClass(CONFIG.CSS.MODAL.BODY);\r\n\t\t\t});\r\n\r\n\t\t\t$(CONFIG.CSS.MODAL.OVERLAY).click(() => {\r\n\t\t\t\t$(document.body).removeClass(CONFIG.CSS.MODAL.BODY);\r\n\t\t\t});\r\n\r\n\t\t\t$(CONFIG.CSS.MODAL.BUTTON).click(() => {\r\n\t\t\t\tvar urlCart = \"/checkout/cart/add?sku=\" + vtxctx.skus + \"&qty=1&seller=1&redirect=true&sc=1\";\r\n\t\t\t\t$(CONFIG.CSS.MODAL.BUTTON).attr(\"href\", urlCart);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction buildListDelivery(deliverys) {\r\n\t\t\tlet html = '';\r\n\r\n\t\t\tif (deliverys.length) {\r\n\t\t\t\tdeliverys.forEach(({ id, name, price, shippingEstimate }) => {\r\n\t\t\t\t\thtml += `\r\n\t\t\t\t\t\t<li id=\"${id}\" class=\"shipping\">\r\n\t\t\t\t\t\t\t<div class=\"shipping__name\">\r\n\t\t\t\t\t\t\t\t<b>${name}</b>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"shipping__estimate\">\r\n\t\t\t\t\t\t\t\t<p>Entregue em até ${Service.formatEstimate(shippingEstimate)}</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"shipping__price\">\r\n\t\t\t\t\t\t\t\t<p><b>${Service.formatPrice(price)}</b></p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t`;\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(CONFIG.CSS.MODAL.TITLE.ENABLE).show();\r\n\t\t\t\t$(CONFIG.CSS.MODAL.TITLE.EMPTY).hide();\r\n\t\t\t} else {\r\n\t\t\t\t$(CONFIG.CSS.MODAL.TITLE.ENABLE).hide();\r\n\t\t\t\t$(CONFIG.CSS.MODAL.TITLE.EMPTY).show();\r\n\t\t\t}\r\n\r\n\t\t\tif (deliverys.length > 1) {\r\n\t\t\t\thtml += `\r\n\t\t\t\t\t<div style=\"text-align: center;margin-top: 20px;\">\r\n\t\t\t\t\t\t<b>Selecione a opção desejada no carrinho.</b>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`;\r\n\t\t\t}\r\n\r\n\t\t\t$(CONFIG.CSS.MODAL.LIST).html(html);\r\n\t\t\t$(CONFIG.CSS.MODAL.CONTENT).show();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction ServiceAPI() {\r\n\t\treturn {\r\n\t\t\tsimulateShipping,\r\n\t\t\tformatPrice,\r\n\t\t\tformatEstimate,\r\n\t\t\tsaveSelectedDelivery,\r\n\t\t\tgetEstimateDays\r\n\t\t}\r\n\r\n\t\tfunction formatPrice(price) {\r\n\t\t\tlet value = 'R$ ';\r\n\r\n\t\t\tif (price === 0) return 'Grátis';\r\n\r\n\t\t\tprice = price + \"\";\r\n\t\t\tconst [decimal] = price.match(/\\w{2}$/);\r\n\r\n\t\t\tvalue += price.slice(0, price.length - 2);\r\n\t\t\tvalue += ',';\r\n\t\t\tvalue += decimal;\r\n\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tfunction getEstimateDays(estimate) {\r\n\t\t\tif (estimate) {\r\n\t\t\t\tconst match = estimate.match(/\\d+/);\r\n\r\n\t\t\t\treturn +match[0];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction formatEstimate(estimate) {\r\n\t\t\tconst [days] = estimate.match(/\\d+/);\r\n\r\n\t\t\tlet res = days;\r\n\r\n\t\t\tif (days > 1)\r\n\t\t\t\tres += ' dias úteis'\r\n\t\t\telse\r\n\t\t\t\tres += ' dia útil'\r\n\r\n\t\t\treturn res;\r\n\t\t}\r\n\r\n\t\tfunction saveSelectedDelivery(id) {\r\n\t\t\tconst selectedSLA = SLA.find(x => x.id === id);\r\n\r\n\t\t\tlocalStorage.setItem('AG_SeletedDelivery', JSON.stringify(selectedSLA));\r\n\t\t}\r\n\r\n\t\tasync function simulateShipping(address) {\r\n\t\t\tconst request = {\r\n\t\t\t\titems: [{\r\n\t\t\t\t\tid: CONFIG.SERVICE.SKU_ID,\r\n\t\t\t\t\tquantity: 1,\r\n\t\t\t\t\tseller: 1\r\n\t\t\t\t}],\r\n\t\t\t\tpostalCode: address.postalCode,\r\n\t\t\t\tcountry: CONFIG.SERVICE.COUNTRY\r\n\t\t\t};\r\n\r\n\t\t\treturn $.ajax({\r\n\t\t\t\turl: \"/api/checkout/pub/orderForms/simulation\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\",\r\n\t\t\t\tcontentType: \"application/json\",\r\n\t\t\t\tdata: JSON.stringify(request)\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n\n\n//# sourceURL=webpack:///./src/js/B2C-02-detalhe-produto.dev.js?");

/***/ })

/******/ });