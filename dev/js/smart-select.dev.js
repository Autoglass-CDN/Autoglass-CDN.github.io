/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/js/smart-select.dev.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/js/smart-select.dev.js":
/*!************************************!*\
  !*** ./src/js/smart-select.dev.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// Cenários 2, 3 faltam ser realizados.\r\n\r\n(function () {\r\n  const Service = ServiceAPI();\r\n  const View = ViewAPI();\r\n  const Controller = ControllerAPI();\r\n\r\n  const CONFIG = {\r\n    ASYNC: {\r\n      MAP_PARAMS: [\r\n        'PS=20&map=c,c,c', // DEFAULT\r\n        ',specificationFilter_36', // MONTADORA\r\n        ',specificationFilter_50', // VEICULO\r\n        ',specificationFilter_48' // ANO\r\n      ],\r\n      TREE_LEVEL: 2,\r\n      LID_FILTER: 'lid=bf120500-baab-4185-8b70-cc630f7d1c70',\r\n    },\r\n    CSS: {\r\n      HIGHLIGHT: 'highlight',\r\n      EMPTY: 'empty',\r\n      ARROW_DOWN: 'fa-caret-down',\r\n      CLOSE: 'fa-close',\r\n      SELECTED: 'selected',\r\n    },\r\n    CANT_OPEN: false,\r\n  }\r\n\r\n  const SELECTS = [\r\n    {\r\n      title: 'Produto',\r\n      class: 'produtos',\r\n      values: [],\r\n      routeSelected: '',\r\n      isAsyncSearch: false,\r\n      asyncSearchTerm: '',\r\n      canBeClear: false,\r\n    },\r\n    {\r\n      title: 'Peça',\r\n      class: 'peca',\r\n      values: [],\r\n      routeSelected: '',\r\n      isAsyncSearch: true,\r\n      asyncSearchTerm: '',\r\n      canBeClear: true,\r\n    },\r\n    {\r\n      title: 'Montadora',\r\n      class: 'montadora',\r\n      values: [],\r\n      routeSelected: '',\r\n      isAsyncSearch: true,\r\n      asyncSearchTerm: '.Compatibilidade.Montadora',\r\n      canBeClear: true,\r\n    },\r\n    {\r\n      title: 'Veículo',\r\n      class: 'veiculo',\r\n      values: [],\r\n      routeSelected: '',\r\n      isAsyncSearch: true,\r\n      asyncSearchTerm: '.Veículo',\r\n      canBeClear: true,\r\n    },\r\n    {\r\n      title: 'Ano',\r\n      class: 'ano',\r\n      values: [],\r\n      routeSelected: '',\r\n      isAsyncSearch: true,\r\n      asyncSearchTerm: '.Ano',\r\n      canBeClear: true,\r\n    },\r\n  ];\r\n\r\n  _init();\r\n\r\n  async function _init() {\r\n    let categoryTree = await Service.getCategoryTree();\r\n\r\n    categoryTree\r\n      .filter(x => x.hasChildren)\r\n      .forEach(x => {\r\n        SELECTS[0].values.push(...x.children);\r\n      });\r\n\r\n    await Controller.checkRouterParams();\r\n\r\n    View.buildList(SELECTS[0].values, SELECTS[0].class);\r\n\r\n    SELECTS.forEach(View._initSelect_);\r\n\r\n    // Create Button Function\r\n    $('#smart-select-btn').click(Service.search);\r\n\r\n  }\r\n\r\n  function ViewAPI() {\r\n    return {\r\n      _initSelect_,\r\n      buildList,\r\n      selectOptionIfButtonHasValue,\r\n      filterResults,\r\n      resetResults,\r\n      virtualizedDOM,\r\n      createNavigation\r\n    }\r\n\r\n    function _initSelect_(select) {\r\n      $(`.smart-select__main > .${select.class}`).click((e) => {\r\n        $(`.smart-select__main > .${select.class} .smart-select__main-results input`)\r\n          .val('');\r\n\r\n        if (select.values) {\r\n          View.buildList(select.values, select.class);\r\n          View.selectOptionIfButtonHasValue(select.class);\r\n\r\n          if (select.values.length !== 0) {\r\n            $(`.smart-select__main > .${select.class} .smart-select__main-results`)\r\n              .slideToggle('fast')\r\n              .click(e => e.stopPropagation());\r\n\r\n            $(`.smart-select__main > .${select.class} .smart-select__main-results input`)\r\n              .focus();\r\n          }\r\n        }\r\n      });\r\n\r\n      $(`.smart-select__main > .${select.class} > div:first-child`)\r\n        .focus(() => {\r\n          $(`.smart-select__main > .${select.class} > div:first-child`)\r\n            .on('keyup', event => {\r\n              if (event.key === 'Delete' || event.key === 'Backspace') {\r\n                const index = SELECTS.findIndex(x => x.class === select.class);\r\n                View.resetResults(index);\r\n                $(`.smart-select__main > .${select.class}`).click();\r\n              }\r\n\r\n              if (event.key === 'Enter')\r\n                $(`.smart-select__main > .${select.class}`).click();\r\n            })\r\n        })\r\n        .blur(() => {\r\n          $(`.smart-select__main > .${select.class} > div:first-child`).unbind('keyup');\r\n        });\r\n\r\n      $(`.smart-select__main > .${select.class} .smart-select__main-results input`)\r\n        .on('keydown', e => {\r\n          if (e.key === 'Tab' || e.key === 'Enter') {\r\n            e.preventDefault();\r\n            $(`.smart-select__main > .${select.class} ul li.${CONFIG.CSS.HIGHLIGHT}`).click();\r\n          }\r\n\r\n          if (e.key === 'ArrowDown') {\r\n            let index = 0;\r\n\r\n            $(`.smart-select__main > .${select.class} ul li`)\r\n              .each((i, element) => {\r\n                if (element.classList.contains(CONFIG.CSS.HIGHLIGHT)) {\r\n                  index += i + 2;\r\n                  $(element).removeClass(CONFIG.CSS.HIGHLIGHT);\r\n                }\r\n              });\r\n\r\n            if (index <= $(`.smart-select__main > .${select.class} ul li`).length) {\r\n              $(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)\r\n                .addClass(CONFIG.CSS.HIGHLIGHT);\r\n\r\n              $(`.smart-select__main > .${select.class} .smart-select__main-results ul`)\r\n                .animate({\r\n                  scrollTop: $(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)[0].offsetTop\r\n                    - $(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)[0].scrollHeight\r\n                    - $(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)[0].scrollHeight / 2\r\n                }, 100);\r\n            }\r\n            else {\r\n              $(`.smart-select__main > .${select.class} ul li:nth-child(1)`)\r\n                .addClass(CONFIG.CSS.HIGHLIGHT);\r\n\r\n              $(`.smart-select__main > .${select.class} .smart-select__main-results ul`)\r\n                .animate({\r\n                  scrollTop: $(`.smart-select__main > .${select.class} ul li:nth-child(1)`)[0].offsetTop\r\n                    - ($(`.smart-select__main > .${select.class} ul li:nth-child(1)`)[0].scrollHeight\r\n                      + $(`.smart-select__main > .${select.class} ul li:nth-child(1)`)[0].scrollHeight / 2)\r\n                }, 100);\r\n            }\r\n          }\r\n\r\n          if (e.key === 'ArrowUp') {\r\n            let index = 0;\r\n\r\n            $(`.smart-select__main > .${select.class} ul li`)\r\n              .each((i, element) => {\r\n                if (element.classList.contains(CONFIG.CSS.HIGHLIGHT)) {\r\n                  index = i;\r\n                  $(element).removeClass(CONFIG.CSS.HIGHLIGHT);\r\n                }\r\n              });\r\n\r\n            if (index !== 0) {\r\n              $(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)\r\n                .addClass(CONFIG.CSS.HIGHLIGHT);\r\n\r\n              $(`.smart-select__main > .${select.class} .smart-select__main-results ul`)\r\n                .animate({\r\n                  scrollTop: $(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)[0].offsetTop\r\n                    - ($(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)[0].scrollHeight\r\n                      + $(`.smart-select__main > .${select.class} ul li:nth-child(${index})`)[0].scrollHeight / 2)\r\n                }, 100);\r\n            }\r\n            else {\r\n              $(`.smart-select__main > .${select.class} ul li:nth-child(${$(`.smart-select__main > .${select.class} ul li`).length})`)\r\n                .addClass(CONFIG.CSS.HIGHLIGHT);\r\n\r\n              $(`.smart-select__main > .${select.class} .smart-select__main-results ul`)\r\n                .animate({\r\n                  scrollTop: $(`.smart-select__main > .${select.class} ul li:nth-child(${$(`.smart-select__main > .${select.class} ul li`).length})`)[0].offsetTop\r\n                    - ($(`.smart-select__main > .${select.class} ul li:nth-child(${$(`.smart-select__main > .${select.class} ul li`).length})`)[0].scrollHeight\r\n                      + $(`.smart-select__main > .${select.class} ul li:nth-child(${$(`.smart-select__main > .${select.class} ul li`).length})`)[0].scrollHeight / 2)\r\n                }, 100);\r\n            }\r\n          }\r\n        })\r\n        .on('keyup', e => {\r\n          if (!['Tab', 'ArrowDown', 'ArrowUp', 'Enter'].find(x => x === e.key))\r\n            View.filterResults(e, select);\r\n        });\r\n\r\n      // Fecha todos os selects caso já tenha algum aberto.\r\n      $(document).on(\"click\", (e) => {\r\n        var container = $(`.smart-select__main > .${select.class}`);\r\n\r\n        if (!$(e.target).closest(container).length) {\r\n          $(`.smart-select__main > .${select.class} .smart-select__main-results`)\r\n            .slideUp('fast');\r\n        }\r\n      });\r\n    }\r\n\r\n    function buildList(objects, _class) {\r\n      let html = '';\r\n\r\n      if (objects) {\r\n        objects.forEach(x => html += `<li role=\"treeitem\" id=\"${x.id}\">${x.name}</li>`);\r\n\r\n        $(`.smart-select__main > .${_class} ul`).html(html);\r\n\r\n        $(`.smart-select__main > .${_class} ul li`)\r\n          .hover(event => {\r\n            $(`.smart-select__main > .${_class} ul li`)\r\n              .removeClass(CONFIG.CSS.HIGHLIGHT);\r\n\r\n            $(event.target).addClass(CONFIG.CSS.HIGHLIGHT);\r\n          })\r\n          .click(event => Controller.addClick(event, _class));\r\n\r\n        $(`.smart-select__main > .${_class} ul li`).first().addClass(CONFIG.CSS.HIGHLIGHT);\r\n      } else {\r\n        $(`.smart-select__main > .${_class} ul`)\r\n          .html(`<li style=\"background: white; color:#707070; cursor: default\">Nenhum resultado encontrado.</li>`);\r\n      }\r\n    }\r\n\r\n    function selectOptionIfButtonHasValue(type) {\r\n      $(`.smart-select__main > .${type} ul li`)\r\n        .each((_, element) => {\r\n          if (element.innerHTML === $(`.smart-select__main > .${type} div > span`).html())\r\n            $(element).addClass(CONFIG.CSS.SELECTED)\r\n        });\r\n    };\r\n\r\n    function filterResults(event, select) {\r\n      if (event.target.value) {\r\n        const filtered = select.values.filter(y =>\r\n          replaceDiacritics(y.name.toUpperCase())\r\n            .includes(\r\n              replaceDiacritics(event.target.value.toUpperCase())\r\n            )\r\n        );\r\n\r\n        buildList(filtered, select.class)\r\n      }\r\n      else {\r\n        buildList(select.values, select.class);\r\n      }\r\n    };\r\n\r\n    function resetResults(_index) {\r\n      for (let i = _index; i <= (SELECTS.length - 1); i++) {\r\n        const select = SELECTS[i];\r\n        const nextSelect = SELECTS[i + 1];\r\n\r\n        $(`.smart-select__main > .${select.class} > div > span`).html(select.title);\r\n        select.routeSelected = '';\r\n\r\n        if (nextSelect && nextSelect.canBeClear) {\r\n          $(`.smart-select__main > .${nextSelect.class}`).addClass(CONFIG.CSS.EMPTY);\r\n\r\n          nextSelect.values = [];\r\n          nextSelect.routeSelected = '';\r\n        }\r\n\r\n        $(`.smart-select__main > .${select.class} > div > .${CONFIG.CSS.ARROW_DOWN}`).show();\r\n        $(`.smart-select__main > .${select.class} > div > .${CONFIG.CSS.CLOSE}`).hide();\r\n      }\r\n    }\r\n\r\n    function createNavigation(_class, new_title) {\r\n      const index = SELECTS.findIndex(x => x.class === _class);\r\n      const select = SELECTS[index];\r\n      const nextSelect = SELECTS[index + 1];\r\n\r\n      $(`.smart-select__main > .${select.class} > div > span`).html(new_title);\r\n      $(`.smart-select__main > .${select.class} > div > .${CONFIG.CSS.ARROW_DOWN}`).hide();\r\n      $(`.smart-select__main > .${select.class} > div > .${CONFIG.CSS.CLOSE}`)\r\n        .show()\r\n        .on('click', () => resetResults(index));\r\n\r\n      if (nextSelect) {\r\n        $(`.smart-select__main > .${nextSelect.class}`)\r\n          .removeClass(CONFIG.CSS.EMPTY);\r\n\r\n        if (!CONFIG.CANT_OPEN) {\r\n          $(`.smart-select__main > .${nextSelect.class}`)\r\n            .click();\r\n        }\r\n      } else {\r\n        if (!CONFIG.CANT_OPEN) {\r\n          $(`.smart-select__main > .${select.class}`).click().focus();\r\n        }\r\n      }\r\n    }\r\n\r\n    function virtualizedDOM(elements, tagReturn) {\r\n      const DOM = document.createElement('div');\r\n\r\n      DOM.innerHTML = elements;\r\n\r\n      return [...DOM.querySelectorAll(`${tagReturn} > li > a`)]\r\n        .map(x => ({\r\n          id: x.href,\r\n          name: x.innerHTML.replace(/\\s\\(\\d+\\)/, ''),\r\n          pathname: x.pathname,\r\n          search: x.search\r\n        }));\r\n    }\r\n\r\n    function replaceDiacritics(str) {\r\n      const diacritics = [\r\n        { char: 'A', base: /[\\300-\\306]/g },\r\n        { char: 'a', base: /[\\340-\\346]/g },\r\n        { char: 'E', base: /[\\310-\\313]/g },\r\n        { char: 'e', base: /[\\350-\\353]/g },\r\n        { char: 'I', base: /[\\314-\\317]/g },\r\n        { char: 'i', base: /[\\354-\\357]/g },\r\n        { char: 'O', base: /[\\322-\\330]/g },\r\n        { char: 'o', base: /[\\362-\\370]/g },\r\n        { char: 'U', base: /[\\331-\\334]/g },\r\n        { char: 'u', base: /[\\371-\\374]/g },\r\n        { char: 'N', base: /[\\321]/g },\r\n        { char: 'n', base: /[\\361]/g },\r\n        { char: 'C', base: /[\\307]/g },\r\n        { char: 'c', base: /[\\347]/g }\r\n      ]\r\n\r\n      diacritics.forEach(function (letter) {\r\n        str = str.replace(letter.base, letter.char);\r\n      });\r\n\r\n      return str;\r\n    };\r\n  }\r\n\r\n  function ControllerAPI() {\r\n    return {\r\n      addClick,\r\n      checkRouterParams\r\n    };\r\n\r\n    async function addClick(event, _class) {\r\n      const index = SELECTS.findIndex(x => x.class === _class);\r\n      const select = SELECTS[index];\r\n      const nextSelect = SELECTS[index + 1];\r\n      // Não pode ser === Pq um pode ser INT e outro STRING, mas o valores são iguais;\r\n      const optionSelected = select.values.find(x => x.id == event.target.id);\r\n\r\n      View.resetResults(index);\r\n\r\n      if (index !== 0) {\r\n        select.routeSelected = optionSelected.url\r\n          ? optionSelected.url.replace(location.origin, '')\r\n          : optionSelected.name;\r\n      }\r\n\r\n      if (nextSelect) {\r\n        if (optionSelected && select.isAsyncSearch) {\r\n          const response = await Service.getFilters(index, select, optionSelected);\r\n\r\n          let values = View.virtualizedDOM(response, nextSelect.asyncSearchTerm);\r\n\r\n          // Caso seja Ano (Ultimo campo) tem que ser decrescente\r\n          (index + 1) === (SELECTS.length - 1)\r\n            ? values.sort((a, b) => b.name.localeCompare(a.name))\r\n            : values.sort((a, b) => a.name.localeCompare(b.name))\r\n\r\n          nextSelect.values = values;\r\n        } else {\r\n          nextSelect.values = optionSelected.children\r\n            .sort((a, b) => a.name.localeCompare(b.name));\r\n        }\r\n\r\n        View.buildList(nextSelect.values, nextSelect.class);\r\n      }\r\n\r\n      View.createNavigation(select.class, event.target.innerHTML);\r\n    }\r\n\r\n    async function checkRouterParams() {\r\n      let { pathname, search } = location;\r\n\r\n      if (search && search.includes(CONFIG.ASYNC.MAP_PARAMS[0])) {\r\n        CONFIG.CANT_OPEN = true;\r\n        const arrayPaths = decodeURI(pathname).split('/').filter(x => x);\r\n\r\n        const { input, ...rest } = arrayPaths\r\n          .slice(0, 3)\r\n          .join('/')\r\n          .match(/(\\w+\\/\\w+)/);\r\n\r\n        const params = [\r\n          rest[0],\r\n          input,\r\n          ...arrayPaths.slice(3, arrayPaths.length)\r\n        ];\r\n\r\n        for (let i = 0; i < params.length; i++) {\r\n          const select = SELECTS[i];\r\n          const value = select.values.find(x =>\r\n            x.url\r\n              ? x.url.includes(params[i])\r\n              : x.name.includes(params[i])\r\n          );\r\n\r\n          await Controller.addClick(\r\n            {\r\n              target: {\r\n                id: value.id,\r\n                innerHTML: value.name\r\n              }\r\n            },\r\n            select.class\r\n          );\r\n        }\r\n      }\r\n\r\n      CONFIG.CANT_OPEN = false;\r\n    }\r\n  }\r\n\r\n  function ServiceAPI() {\r\n    return {\r\n      buildMapFilters,\r\n      buildURL,\r\n      getCategoryTree,\r\n      getFilters,\r\n      search\r\n    };\r\n\r\n    async function getCategoryTree() {\r\n      return await $.get(`${location.origin}/api/catalog_system/pub/category/tree/${CONFIG.ASYNC.TREE_LEVEL}`);\r\n    }\r\n\r\n    async function getFilters(index, select, optionSelected) {\r\n      const url = Service.buildURL(index, select, optionSelected);\r\n\r\n      return await $.get(url);\r\n    }\r\n\r\n    function getPaths() {\r\n      return SELECTS\r\n        .filter(x => x.routeSelected)\r\n        .map(x => x.routeSelected.includes('/')\r\n          ? x.routeSelected\r\n          : `/${x.routeSelected}`)\r\n        .join('');\r\n    }\r\n\r\n    async function search() {\r\n      const index = SELECTS.filter(x => x.routeSelected).length;\r\n      const paths = getPaths();\r\n      let url = location.origin;\r\n\r\n      if (paths) {\r\n        url += paths;\r\n        url += `?${buildMapFilters(index - 1)}`;\r\n      }\r\n\r\n      location.href = url;\r\n    }\r\n\r\n    function buildMapFilters(step) {\r\n      let params = '';\r\n\r\n      for (let i = 0; i <= step; i++) {\r\n        params += CONFIG.ASYNC.MAP_PARAMS[i];\r\n      }\r\n\r\n      return params;\r\n    }\r\n\r\n    function buildURL(index, select, optionSelected) {\r\n      const paths = getPaths();\r\n      let url = '';\r\n\r\n      if (select.asyncSearchTerm) {\r\n        url += location.origin;\r\n        url += paths;\r\n      } else {\r\n        url += optionSelected.url;\r\n      }\r\n\r\n      url += `?${CONFIG.ASYNC.LID_FILTER}&${buildMapFilters(--index)}`;\r\n\r\n      return url;\r\n    }\r\n  }\r\n})();\n\n//# sourceURL=webpack:///./src/js/smart-select.dev.js?");

/***/ })

/******/ });