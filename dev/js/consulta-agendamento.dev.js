/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/js/consulta-agendamento.dev.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/js/consulta-agendamento.dev.js":
/*!********************************************!*\
  !*** ./src/js/consulta-agendamento.dev.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("var codCidades = {\r\n\tSE: { code: \"8529\", nome: \"Sergipe\" },\r\n\tTO: { code: \"9654\", nome: \"Tocantins\" },\r\n\t// RO: { code: \"76803888\", nome: \"Rond\\u00f4nia\" },\r\n\t// RR: { code: \"69300000\", nome: \"Roraima\" },\r\n\t// AC: { code: \"69922000\", nome: \"Acre\" },\r\n\t// AP: { code: \"68950000\", nome: \"Amap\\u00e1\" },\r\n\tBA: { code: \"981\", nome: \"Bahia\" },\r\n\tES: { code: \"1974\", nome: \"Esp\\u00edrito Santo\" },\r\n\tDF: { code: \"1730\", nome: \"Distrito Federal\" },\r\n\tRS: { code: \"7778\", nome: \"Rio Grande do Sul\" },\r\n\tRJ: { code: \"6808\", nome: \"Rio de Janeiro\" },\r\n\tMT: { code: \"4282\", nome: \"Mato Grosso\" },\r\n\tPR: { code: \"5916\", nome: \"Paran\\u00e1\" },\r\n\tMS: { code: \"4079\", nome: \"Mato Grosso do Sul\" },\r\n\tGO: { code: \"2015\", nome: \"Goi\\u00e1s\" },\r\n\tAL: { code: \"107\", nome: \"Alagoas\" },\r\n\tCE: { code: \"1320\", nome: \"Cear\\u00e1\" },\r\n\tPA: { code: \"4499\", nome: \"Par\\u00e1\" },\r\n\tRN: { code: \"7040\", nome: \"Rio Grande do Norte\" },\r\n\tSC: { code: \"8269\", nome: \"Santa Catarina\" },\r\n\tMA: { code: \"2533\", nome: \"Maranh\\u00e3o\" },\r\n\tPI: { code: \"5647\", nome: \"Piau\\u00ed\" },\r\n\tMG: { code: \"3631\", nome: \"Minas Gerais\" },\r\n\tPB: { code: \"4823\", nome: \"Para\\u00edba\" },\r\n\tAM: { code: \"240\", nome: \"Amazonas\" },\r\n\tPE: { code: \"5229\", nome: \"Pernambuco\" },\r\n\tSP: { code: \"9423\", nome: \"S\\u00e3o Paulo\" },\r\n};\r\n\r\n// #region Instale na Loja - NOVO\r\n// $(function () {\r\n//   let PICKUP_POINTS = [];\r\n\r\n//   const CONFIG = {\r\n//     SERVICE: {\r\n//       COUNTRY: 'BRA',\r\n//       SKU_ID: vtxctx.skus\r\n//     },\r\n//     CSS: {\r\n//       BASE: '.mz-modal-installation',\r\n//       MODAL_LIST: '.store-list ul'\r\n//     }\r\n//   }\r\n\r\n//   const hmlCodServico = \"17\";\r\n//   const baseUrlApi = //window.location.href.includes(\"dev\")\r\n//     //? \"https://api-hml.autoglass.com.br/integracao-b2c/api/web-app/agendamentos\"\r\n//     //: \r\n//     \"https://api.autoglass.com.br/integracao-b2c/api/web-app/agendamentos\";\r\n//   let estado = codCidades[$.cookie(\"mzLocationUF\")];\r\n//   let codCidade = estado.code || null;\r\n\r\n//   if (window.location.href.includes('checkout')) {\r\n//     $(window).on('orderFormUpdated.vtex', (_, order) => {\r\n//       if (order.shippingData.address && order.shippingData.address.state) {\r\n//         estado = codCidades[order.shippingData.address.state];\r\n//         codCidade = estado.code || null;\r\n\r\n//         $('.store').remove();\r\n\r\n//         recuperarHorarios(orderForm.shippingData.address);\r\n//       }\r\n//     });\r\n//   }\r\n\r\n//   let tomorrow = new Date();\r\n//   tomorrow.setDate(tomorrow.getDate() + 1);\r\n\r\n//   $(\".secao-agendamento > .store-list > .filter > .data input\").datepicker({\r\n//     dateFormat: \"dd/mm/yy\",\r\n//     dayNames: [\r\n//       \"Domingo\",\r\n//       \"Segunda\",\r\n//       \"Terça\",\r\n//       \"Quarta\",\r\n//       \"Quinta\",\r\n//       \"Sexta\",\r\n//       \"Sábado\",\r\n//       \"Domingo\",\r\n//     ],\r\n//     dayNamesMin: [\"D\", \"S\", \"T\", \"Q\", \"Q\", \"S\", \"S\", \"D\"],\r\n//     dayNamesShort: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sáb\", \"Dom\"],\r\n//     monthNames: [\r\n//       \"Janeiro\",\r\n//       \"Fevereiro\",\r\n//       \"Março\",\r\n//       \"Abril\",\r\n//       \"Maio\",\r\n//       \"Junho\",\r\n//       \"Julho\",\r\n//       \"Agosto\",\r\n//       \"Setembro\",\r\n//       \"Outubro\",\r\n//       \"Novembro\",\r\n//       \"Dezembro\",\r\n//     ],\r\n//     monthNamesShort: [\r\n//       \"Jan\",\r\n//       \"Fev\",\r\n//       \"Mar\",\r\n//       \"Abr\",\r\n//       \"Mai\",\r\n//       \"Jun\",\r\n//       \"Jul\",\r\n//       \"Ago\",\r\n//       \"Set\",\r\n//       \"Out\",\r\n//       \"Nov\",\r\n//       \"Dez\",\r\n//     ],\r\n//     minDate: tomorrow,\r\n//     beforeShowDay: (data) => {\r\n//       return [!data.toDateString().includes(\"Sun\")];\r\n//     },\r\n//     onSelect: () => {\r\n//       $(\".secao-agendamento > .store-list .store\").remove();\r\n//       $(\".secao-agendamento > .store-list #sem-lojas\").remove();\r\n//       const address = JSON.parse(localStorage.getItem('AG_AddressSelected'));\r\n//       if (address)\r\n//         recuperarHorarios(address);\r\n//     },\r\n//   });\r\n//   $(\".secao-agendamento > .store-list > .filter > .data input\").datepicker(\r\n//     \"setDate\",\r\n//     tomorrow\r\n//   );\r\n\r\n//   $(\"#btn-alterar-local-instalacao\").click(function () {\r\n//     $(\".mz-install__close--button\").click();\r\n//     $(\"#btn-alterar-open-modal\").click();\r\n//   });\r\n\r\n//   _init();\r\n\r\n//   function _init() {\r\n//     const address = JSON.parse(localStorage.getItem('AG_AddressSelected'));\r\n\r\n//     if (address) {\r\n//       recuperarHorarios(address);\r\n//     } else {\r\n//       // Evento lançado pelo componente de cep\r\n//       $(window).on('cep-finish-load', e => {\r\n//         const orderForm = e.originalEvent.detail;\r\n//         recuperarHorarios(orderForm.shippingData.address);\r\n//       });\r\n//     }\r\n\r\n//     // Evento lançado pelo componente de cep\r\n//     $(window).on('cep-updated', e => {\r\n//       const orderForm = e.originalEvent.detail;\r\n//       console.log(orderForm.shippingData.address)\r\n//       recuperarHorarios(orderForm.shippingData.address);\r\n//     })\r\n//   }\r\n\r\n//   async function recuperarHorarios(address) {\r\n\r\n//     try {\r\n//       let result = await $.ajax({\r\n//         method: \"GET\",\r\n//         url: `${baseUrlApi}/horarios-lojas?Data=${$(\".secao-agendamento .data input\")\r\n//           .datepicker(\"getDate\")\r\n//           .toISOString()\r\n//           .split(\"T\")[0]\r\n//           }&CodigoServico=${hmlCodServico}&CodigoCidade=${codCidade}`,\r\n//       });\r\n\r\n//       $(\".secao-agendamento .qtd\").text(`Lojas encontradas: ${result.Total}`);\r\n//       if (result.Total === 0)\r\n//         $(\".secao-agendamento > .store-list\").append(noTimeAvailable());\r\n\r\n//       if (address) {\r\n//         let shippingData = await simulateShipping(address);\r\n\r\n\r\n//         PICKUP_POINTS = shippingData\r\n//           .logisticsInfo[0]\r\n//           .slas\r\n//           .filter(x => x.deliveryChannel === 'pickup-in-point');\r\n\r\n//         $(\".secao-agendamento > .store-list\").append(`<ul></ul>`);\r\n\r\n//         PICKUP_POINTS.forEach((pickupPoint, index) => {\r\n//           let store = result.Registros.find(store => /(PG|MG|RC|SP|NW)[\\d]{2,}/g.test(store.Nome));\r\n//           $(\".secao-agendamento > .store-list ul\").append(`${populateStore(store, pickupPoint)}`);\r\n//         });\r\n//       }\r\n\r\n\r\n//       async function simulateShipping(address) {\r\n//         const request = {\r\n//           items: [{\r\n//             id: CONFIG.SERVICE.SKU_ID,\r\n//             quantity: 1,\r\n//             seller: 1\r\n//           }],\r\n//           postalCode: address.postalCode,\r\n//           country: CONFIG.SERVICE.COUNTRY\r\n//         };\r\n\r\n//         return $.ajax({\r\n//           url: \"/api/checkout/pub/orderForms/simulation\",\r\n//           type: \"POST\",\r\n//           dataType: \"JSON\",\r\n//           contentType: \"application/json\",\r\n//           data: JSON.stringify(request)\r\n//         });\r\n//       }\r\n\r\n//       $('.timestamp').click(function () {\r\n//         $('.pickup').removeClass('selected');\r\n//         $(this).parent('.pickup').addClass('selected');\r\n\r\n//         saveSelectedPickupPoint($(this).parents('.pickup').attr('id'));\r\n\r\n//         if (window.location.href.includes('checkout')) {\r\n//           $('body').removeClass('mz-bo-on mz-as-on mz-il-on');\r\n//         }\r\n\r\n//         $('.mz-install__button--buy').click(e => e.preventDefault());\r\n\r\n//         const loja = $(this).attr('data-store');\r\n//         const cep = $(this).attr('data-cep');\r\n//         const horario = $(this).html();\r\n//         const date = $(\".secao-agendamento .data input\")\r\n//           .datepicker(\"getDate\")\r\n//           .toISOString()\r\n//           .split(\"T\")[0];\r\n\r\n//         localStorage.setItem('AG_SelectedHour', JSON.stringify({\r\n//           loja,\r\n//           horario,\r\n//           date,\r\n//           _createAt: Date.now()\r\n//         }));\r\n\r\n//         vtexjs.checkout.calculateShipping({\r\n//           postalCode: cep,\r\n//           country: 'BRA',\r\n//           addressType: 'search'\r\n//         }).then((order) => { forceChangeShipping(order); $('.mz-install__button--buy').unbind('click'); });\r\n\r\n//         function saveSelectedPickupPoint(id) {\r\n//           const sla = PICKUP_POINTS.find(x => x.pickupStoreInfo.address.addressId === id);\r\n\r\n//           localStorage.setItem('AG_SeletedPickupPoint', JSON.stringify(sla));\r\n//           sendCalculateShipping(sla.pickupStoreInfo.address.postalCode, 'search');\r\n//         }\r\n//         function sendCalculateShipping(cep, type) {\r\n//           $('.mz-pickup__button--buy').click(e => e.preventDefault());\r\n\r\n//           vtexjs.checkout.calculateShipping({\r\n//             postalCode: cep,\r\n//             country: 'BRA',\r\n//             addressType: type\r\n//           }).then(order => { forceChangeShipping(order); $('.mz-pickup__button--buy').unbind('click'); });\r\n//         }\r\n//       });\r\n\r\n//     } catch (error) {\r\n//       console.error(error);\r\n//       $(\".secao-agendamento > .store-list\").append(noTimeAvailable());\r\n//     }\r\n\r\n\t\t// $.ajax({\r\n\t\t//   method: \"GET\",\r\n\t\t//   url: `${baseUrlApi}/horarios-lojas?Data=${$(\".secao-agendamento .data input\")\r\n\t\t//     .datepicker(\"getDate\")\r\n\t\t//     .toISOString()\r\n\t\t//     .split(\"T\")[0]\r\n\t\t//     }&CodigoServico=${hmlCodServico}&CodigoCidade=${codCidade}`,\r\n\t\t// })\r\n\t\t//   .done(async function (data) {\r\n\t\t//     $(\".secao-agendamento .qtd\").text(`Lojas encontradas: ${data.Total}`);\r\n\t\t//     if (data.Total === 0)\r\n\t\t//       $(\".secao-agendamento > .store-list\").append(noTimeAvailable());\r\n\r\n\t\t//     if (address) {\r\n\t\t//       let shippingData = await simulateShipping(address);\r\n\r\n\r\n\t\t//       PICKUP_POINTS = shippingData\r\n\t\t//         .logisticsInfo[0]\r\n\t\t//         .slas\r\n\t\t//         .filter(x => x.deliveryChannel === 'pickup-in-point');\r\n\r\n\t\t//       $(\".secao-agendamento > .store-list\").append(`<ul></ul>`);\r\n\r\n\t\t//       PICKUP_POINTS.forEach((pickupPoint, index) => {\r\n\t\t//         let store = data.Registros.find(store => /(PG|MG|RC|SP|NW)[\\d]{2,}/g.test(store.Nome));\r\n\t\t//         $(\".secao-agendamento > .store-list ul\").append(`${populateStore(store, pickupPoint)}`);\r\n\t\t//       });\r\n\t\t//     }\r\n\r\n\r\n//     //     async function simulateShipping(address) {\r\n//     //       const request = {\r\n//     //         items: [{\r\n//     //           id: CONFIG.SERVICE.SKU_ID,\r\n//     //           quantity: 1,\r\n//     //           seller: 1\r\n//     //         }],\r\n//     //         postalCode: address.postalCode,\r\n//     //         country: CONFIG.SERVICE.COUNTRY\r\n//     //       };\r\n\r\n//     //       return $.ajax({\r\n//     //         url: \"/api/checkout/pub/orderForms/simulation\",\r\n//     //         type: \"POST\",\r\n//     //         dataType: \"JSON\",\r\n//     //         contentType: \"application/json\",\r\n//     //         data: JSON.stringify(request)\r\n//     //       });\r\n//     //     }\r\n\r\n//     //     $('.timestamp').click(function () {\r\n//     //       $('.pickup').removeClass('selected');\r\n//     //       $(this).parent('.pickup').addClass('selected');\r\n\r\n//     //       saveSelectedPickupPoint($(this).attr('id'));\r\n\r\n//     //       if (window.location.href.includes('checkout')) {\r\n//     //         $('body').removeClass('mz-bo-on mz-as-on mz-il-on');\r\n//     //       }\r\n\r\n//     //       $('.mz-install__button--buy').click(e => e.preventDefault());\r\n\r\n//     //       const loja = $(this).attr('data-store');\r\n//     //       const cep = $(this).attr('data-cep');\r\n//     //       const horario = $(this).html();\r\n//     //       const date = $(\".secao-agendamento .data input\")\r\n//     //         .datepicker(\"getDate\")\r\n//     //         .toISOString()\r\n//     //         .split(\"T\")[0];\r\n\r\n//     //       localStorage.setItem('AG_SelectedHour', JSON.stringify({\r\n//     //         loja,\r\n//     //         horario,\r\n//     //         date,\r\n//     //         _createAt: Date.now()\r\n//     //       }));\r\n\r\n//     //       vtexjs.checkout.calculateShipping({\r\n//     //         postalCode: cep,\r\n//     //         country: 'BRA',\r\n//     //         addressType: 'search'\r\n//     //       }).then((order) => { forceChangeShipping(order); $('.mz-install__button--buy').unbind('click'); });\r\n\r\n//     //       function saveSelectedPickupPoint(id) {\r\n//     //         const sla = PICKUP_POINTS.find(x => x.id === id);\r\n\r\n//     //         localStorage.setItem('AG_SeletedPickupPoint', JSON.stringify(sla));\r\n//     //         sendCalculateShipping(sla.pickupStoreInfo.address.postalCode, 'search');\r\n//     //       }\r\n//     //     });\r\n//     //   })\r\n//     //   .fail(() =>\r\n//     //     $(\".secao-agendamento > .store-list\").append(noTimeAvailable())\r\n//     //   );\r\n\r\n//     // $(\".store-info .btn-ver-horarios:not(.danger)\").click(function () {\r\n//     //   $(this).parent().next().toggleClass(\"hidden\");\r\n//     // });\r\n//   }\r\n\r\n//   function populateStore(store, { id, shippingEstimate, pickupDistance, pickupStoreInfo }) {\r\n//     return `\r\n// \t\t\t\t\t\t<li id=\"${pickupStoreInfo.address.addressId}\" class=\"pickup\">\r\n// \t\t\t\t\t\t\t<div class=\"pickup__info\">\r\n// \t\t\t\t\t\t\t\t<div class=\"pickup__info-distance\">\r\n// \t\t\t\t\t\t\t\t\t<svg class=\"pkpmodal-pickup-point-best-marker-image\" width=\"25\" height=\"32\" viewBox=\"0 0 25 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19.4917 22.3169L19.4918 22.3169L19.4967 22.3096C19.5843 22.1782 19.6709 22.0485 19.7564 21.9204C22.0478 18.4883 23.5645 16.2165 23.5645 12.5323C23.5645 6.16317 18.4013 1 12.0323 1C5.66317 1 0.5 6.16317 0.5 12.5323C0.5 16.5417 3.05396 20.5158 5.20313 23.2599C6.56216 24.9952 9.21424 28.1986 11.703 30.3763L12.0323 30.6644L12.3615 30.3763C14.8402 28.2075 16.7075 26.3386 19.4917 22.3169Z\" fill=\"#2D78F6\" stroke=\"white\"></path><path d=\"M18.6968 9.73418L14.6509 9.14642L12.8407 5.48019C12.5239 4.83994 11.4759 4.83994 11.159 5.48019L9.3498 9.14642L5.30298 9.73418C4.53711 9.84573 4.22682 10.7906 4.78365 11.3344L7.71213 14.1878L7.02126 18.2178C6.89096 18.9808 7.69338 19.5667 8.38145 19.2058L11.9999 17.3038L15.6192 19.2068C16.3017 19.5639 17.1107 18.9874 16.9794 18.2187L16.2885 14.1888L19.217 11.3353C19.7729 10.7906 19.4626 9.84573 18.6968 9.73418Z\" fill=\"white\"></path></svg>\r\n// \t\t\t\t\t\t\t\t\t<p>${pickupDistance.toFixed(1)} km</p>\r\n// \t\t\t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t\t\t<div class=\"pickup__info-address\">\r\n// \t\t\t\t\t\t\t\t\t<div class=\"address-title\">\r\n// \t\t\t\t\t\t\t\t\t\t<b>${pickupStoreInfo.friendlyName}</b>\r\n// \t\t\t\t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t\t\t\t<p class=\"address-location\">\r\n// \t\t\t\t\t\t\t\t\t\t${pickupStoreInfo.address.street} ${pickupStoreInfo.address.number},\r\n// \t\t\t\t\t\t\t\t\t\t${pickupStoreInfo.address.complement}\r\n// \t\t\t\t\t\t\t\t\t</p>\r\n// \t\t\t\t\t\t\t\t\t<p class=\"pickup__info-city\">${pickupStoreInfo.address.neighborhood} - ${pickupStoreInfo.address.city} - ${pickupStoreInfo.address.state}</p>\r\n// \t\t\t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t\t</div>\r\n// \t\t\t\t\t\t\t<div class=\"pickup__estimate\">\r\n// \t\t\t\t\t\t\t\t<span>Grátis</span>\r\n// \t\t\t\t\t\t\t\t<span>Pronto em até ${calculateTimeEstimate(shippingEstimate)}</span>\r\n//               </div>\r\n//               <div class=\"time\">\r\n//                 <p>Horários:</p>\r\n//                 <div class=\"time-list\">\r\n//                 ${createTimestampList(store.Horarios, `${store.Nome} | ${store.Bairro}`, store.Cep).join(\"\\n\")}\r\n//                 </div>\r\n//               </div>\r\n// \t\t\t\t\t\t</li>\r\n//             `;\r\n//   }\r\n\r\n//   function calculateTimeEstimate(estimate) {\r\n//     const days = +estimate[0];\r\n\r\n//     return days + (days > 0 ? ' dias úteis' : ' dia útil');\r\n//   }\r\n\r\n//   // function populateStore(store) {\r\n//   //   return `<div class=\"store\">\r\n//   // \t<div class=\"store-info\">\r\n//   // \t  <div class=\"aside\">\r\n//   // \t\t<h5 class=\"store-name\">\r\n//   // \t\t  ${store.Nome} | ${store.Bairro}\r\n//   // \t\t</h5>\r\n//   // \t\t<p class=\"address\">\r\n//   // \t\t  ${store.Logradouro.toLowerCase()}, ${store.Bairro.toLowerCase()}, ${store.Cidade.toLowerCase()}, \r\n//   // \t\t  ${store.NumeroResidencial}, ${store.UF}, ${store.Cep}\r\n//   // \t\t</p>\r\n//   // \t  </div>\r\n//   // \t  <button class=\"btn-ver-horarios ${store.Horarios.filter((h) => h.Disponibilidade.Value !== \"Nao\").length >\r\n//   //       0\r\n//   //       ? \"\"\r\n//   //       : \"danger\"\r\n//   //     }\">${store.Horarios.filter((h) => h.Disponibilidade.Value !== \"Nao\").length > 0 ? \"Ver horários\" : \"Horários indisponíveis\"}</button>\r\n//   // \t</div>\r\n//   // \t<div class=\"time hidden\">\r\n//   // \t  <p>Horários:</p>\r\n//   // \t  <div class=\"time-list\">\r\n//   // \t\t${createTimestampList(store.Horarios, `${store.Nome} | ${store.Bairro}`, store.Cep).join(\"\\n\")}\r\n//   // \t  </div>\r\n//   // \t</div>\r\n//   //   </div>`;\r\n//   // }\r\n\r\n//   function createTimestampList(horarios, store, cep) {\r\n//     return horarios.map(function (horario) {\r\n//       let timestamp = new Date(horario.HoraInicial);\r\n//       return horario.Disponibilidade.Value !== \"Nao\"\r\n//         ? `<button data-store=\"${store}\" data-cep=\"${cep}\" class=\"timestamp\">${timestamp.toLocaleTimeString([], {\r\n//           hour: \"2-digit\",\r\n//           minute: \"2-digit\",\r\n//         })}</button>`\r\n//         : \"\";\r\n//     });\r\n//   }\r\n\r\n//   function noTimeAvailable() {\r\n//     return `<div id=\"sem-lojas\" style=\"\r\n//       min-height: 100px;\r\n//       display: flex;\r\n//       flex-direction: column;\r\n//       justify-content: space-evenly;\">\r\n//       <p style=\"text-align: center;\">\r\n//         Não encontramos horários de instalação disponíveis para essa data.\r\n//       </p>\r\n//       <small style=\"text-align: center;\">\r\n//         Por favor, tente outras datas ou fale com nossos consultores no chat.\r\n//       </small>\r\n//     </div>`;\r\n//   }\r\n\r\n//   function forceChangeShipping(orderForm) {\r\n//     const newSelectedAddresses = [orderForm.shippingData.availableAddresses[orderForm.shippingData.availableAddresses.length - 1]];\r\n//     const logistic = orderForm.shippingData.logisticsInfo[0];\r\n\r\n//     if (logistic) {\r\n//       const slas = logistic.slas.filter(x => x.deliveryChannel === 'pickup-in-point');\r\n//       const logisticsInfo = orderForm.shippingData.logisticsInfo.map(x => {\r\n//         return {\r\n//           addressId: newSelectedAddresses[0].addressId,\r\n//           itemIndex: x.itemIndex,\r\n//           selectedDeleveryChannel: 'pickup-in-point',\r\n//           selectedSla: slas[0].id\r\n//         }\r\n//       });\r\n\r\n//       fetch(`/api/checkout/pub/orderForm/${orderForm.orderFormId}/attachments/shippingData`, {\r\n//         method: 'post',\r\n//         body: JSON.stringify({\r\n//           clearAddressIfPostalCodeNotFound: false,\r\n//           expectedOrderFormSections: ['shippingData'],\r\n//           selectedAddresses: newSelectedAddresses,\r\n//           logisticsInfo\r\n//         })\r\n//       }).then(res => res.json()).then(x => {\r\n//         vtexjs.checkout.sendAttachment('shippingData', {\r\n//           selectedAddresses: newSelectedAddresses,\r\n//           logisticsInfo\r\n//         });\r\n//       });\r\n//     }\r\n//   }\r\n// });\r\n// #endregion Instale na Loja - NOVO\r\n\r\n// Instale na Loja\r\n$(function () {\r\n\tconst hmlCodServico = \"17\";\r\n\tconst baseUrlApi = window.location.href.includes(\"dev\")\r\n\t\t? \"https://api-hml.autoglass.com.br/integracao-b2c/api/web-app/agendamentos\"\r\n\t\t: \"https://api.autoglass.com.br/integracao-b2c/api/web-app/agendamentos\";\r\n\tlet estado = codCidades[$.cookie(\"mzLocationUF\")];\r\n\tlet codCidade = estado.code || null;\r\n\r\n\tif (window.location.href.includes('checkout')) {\r\n\t\t$(window).on('orderFormUpdated.vtex', async (_, order) => {\r\n\t\t\tif (order.shippingData.address && order.shippingData.address.state) {\r\n\t\t\t\testado = codCidades[order.shippingData.address.state];\r\n\t\t\t\tcodCidade = estado.code || null;\r\n\r\n\t\t\t\t$('.store').remove();\r\n\r\n\t\t\t\tconst datas = await getDeliveriesEstimates(order.shippingData.address.postalCode, order.shippingData.logisticsInfo, order.items);\r\n\t\t\t\tsetMinDateDatepicker(datas);\r\n\t\t\t\trecuperarHorarios(datas);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * TESTE\r\n\t */\r\n\r\n// \t async function teste() {\r\n// \tconst installmentProduct = await vtexjs.catalog.getProductWithVariations(12685);\r\n// \tconst currentProduct = await vtexjs.catalog.getCurrentProductWithVariations();\r\n// \tsimulationItems = [\r\n// \t\t{\r\n// \t\t\tquantity: 1,\r\n// \t\t\tseller: currentProduct.skus[0].sellerId,\r\n// \t\t\tid: currentProduct.skus[0].sku\r\n// \t\t},\r\n// \t\t{\r\n// \t\t\tquantity: 1,\r\n// \t\t\tseller: installmentProduct.skus[0].sellerId,\r\n// \t\t\tid: installmentProduct.skus[0].sku\r\n// \t\t}\r\n// \t];\r\n\r\n\r\n// \tpostalCode = 29092095\r\n// const { logisticsInfo } = await $.ajax({\r\n// \ttype: 'POST',\r\n// \turl: '/api/checkout/pub/orderForms/simulation',\r\n// \tdataType: 'json',\r\n// \tcontentType: 'application/json',\r\n// \tdata: JSON.stringify({\r\n// \t\tcountry: 'BRA',\r\n// \t\titems: simulationItems,\r\n// \t\tpostalCode\r\n// \t})\r\n// });\r\n\r\n// console.log(logisticsInfo)\r\n// \t }\r\n// \t teste()\r\n\r\n\t// let shippingData = await simulateShipping(address);\r\n\t/**\r\n\t * Teste fim\r\n\t */\r\n\r\n\tlet tomorrow = new Date();\r\n\ttomorrow.setDate(tomorrow.getDate() + 2);\r\n\r\n\t$(\".secao-agendamento > .store-list > .filter > .data input\").datepicker({\r\n\t\tdateFormat: \"dd/mm/yy\",\r\n\t\tdayNames: [\r\n\t\t\t\"Domingo\",\r\n\t\t\t\"Segunda\",\r\n\t\t\t\"Terça\",\r\n\t\t\t\"Quarta\",\r\n\t\t\t\"Quinta\",\r\n\t\t\t\"Sexta\",\r\n\t\t\t\"Sábado\",\r\n\t\t\t\"Domingo\",\r\n\t\t],\r\n\t\tdayNamesMin: [\"D\", \"S\", \"T\", \"Q\", \"Q\", \"S\", \"S\", \"D\"],\r\n\t\tdayNamesShort: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sáb\", \"Dom\"],\r\n\t\tmonthNames: [\r\n\t\t\t\"Janeiro\",\r\n\t\t\t\"Fevereiro\",\r\n\t\t\t\"Março\",\r\n\t\t\t\"Abril\",\r\n\t\t\t\"Maio\",\r\n\t\t\t\"Junho\",\r\n\t\t\t\"Julho\",\r\n\t\t\t\"Agosto\",\r\n\t\t\t\"Setembro\",\r\n\t\t\t\"Outubro\",\r\n\t\t\t\"Novembro\",\r\n\t\t\t\"Dezembro\",\r\n\t\t],\r\n\t\tmonthNamesShort: [\r\n\t\t\t\"Jan\",\r\n\t\t\t\"Fev\",\r\n\t\t\t\"Mar\",\r\n\t\t\t\"Abr\",\r\n\t\t\t\"Mai\",\r\n\t\t\t\"Jun\",\r\n\t\t\t\"Jul\",\r\n\t\t\t\"Ago\",\r\n\t\t\t\"Set\",\r\n\t\t\t\"Out\",\r\n\t\t\t\"Nov\",\r\n\t\t\t\"Dez\",\r\n\t\t],\r\n\t\tminDate: tomorrow,\r\n\t\tbeforeShowDay: (data) => {\r\n\t\t\treturn [!data.toDateString().includes(\"Sun\")];\r\n\t\t},\r\n\t\tonSelect: () => {\r\n\t\t\t$(\".secao-agendamento > .store-list .store\").remove();\r\n\t\t\t$(\".secao-agendamento > .store-list #sem-lojas\").remove();\r\n\t\t\trecuperarHorarios();\r\n\t\t},\r\n\t});\r\n\r\n\t$(\".secao-agendamento > .store-list > .filter > .data input\")\r\n\t\t.datepicker(\"setDate\", tomorrow);\r\n\r\n\t$(\"#btn-alterar-local-instalacao\").click(function () {\r\n\t\t$(\".mz-install__close--button\").click();\r\n\t\t$(\"#btn-alterar-open-modal\").click();\r\n\t});\r\n\r\n\tconst address = JSON.parse(localStorage.getItem('AG_AddressSelected'));\r\n\r\n\tif (address) {\r\n\t\tlet x;\r\n\r\n\t\tif (typeof vtexjs !== 'undefined' && vtexjs.checkout && vtexjs.checkout.orderForm && vtexjs.checkout.orderForm.items) {\r\n\t\t\tx = vtexjs.checkout.orderForm.items;\r\n\t\t}\r\n\r\n\t\tgetDeliveriesEstimates(address.postalCode, address.logisticsInfo, x)\r\n\t\t\t.then((datas) => {\r\n\t\t\t\tsetMinDateDatepicker(datas);\r\n\t\t\t\trecuperarHorarios(datas);\r\n\t\t\t});\r\n\t} else {\r\n\t\t// Evento lançado pelo componente de cep\r\n\t\t$(window).on('cep-finish-load', async (e) => {\r\n\t\t\tconst orderForm = e.originalEvent.detail;\r\n\t\t\tconst datas = await getDeliveriesEstimates(\r\n\t\t\t\torderForm.shippingData.address.postalCode,\r\n\t\t\t\torderForm.shippingData.logisticsInfo,\r\n\t\t\t\torderForm.items\r\n\t\t\t);\r\n\t\t\tsetMinDateDatepicker(datas);\r\n\t\t\trecuperarHorarios(datas);\r\n\t\t});\r\n\t}\r\n\r\n\t// Evento lançado pelo componente de cep\r\n\t$(window).on('cep-updated', async (e) => {\r\n\t\tconst orderForm = e.originalEvent.detail;\r\n\t\tconst datas = await getDeliveriesEstimates(\r\n\t\t\torderForm.shippingData.address.postalCode,\r\n\t\t\torderForm.shippingData.logisticsInfo,\r\n\t\t\torderForm.items\r\n\t\t);\r\n\t\tsetMinDateDatepicker(datas);\r\n\t\trecuperarHorarios(datas);\r\n\t});\r\n\r\n\t// recuperarHorarios();\r\n\r\n\tfunction setMinDateDatepicker(datas) {\r\n\t\tlet minDate = datas[0].Data;\r\n\r\n\t\tminDate = datas && datas.length\r\n\t\t\t? datas[0].Data\r\n\t\t\t: tomorrow;\r\n\r\n\t\t$(\".secao-agendamento > .store-list > .filter > .data input\")\r\n\t\t\t.datepicker('option', 'minDate', minDate);\r\n\r\n\t\t$(\".secao-agendamento > .store-list > .filter > .data input\")\r\n\t\t\t.datepicker('refresh');\r\n\r\n\t\t$(\".secao-agendamento > .store-list > .filter > .data input\")\r\n\t\t\t.datepicker(\"setDate\", minDate);\r\n\t}\r\n\r\n\tfunction recuperarHorarios(slas) {\r\n\t\t$.ajax({\r\n\t\t\tmethod: \"GET\",\r\n\t\t\turl: `${baseUrlApi}/horarios-lojas?Data=${$(\".secao-agendamento .data input\")\r\n\t\t\t\t.datepicker(\"getDate\")\r\n\t\t\t\t.toISOString()\r\n\t\t\t\t.split(\"T\")[0]\r\n\t\t\t\t}&CodigoServico=${hmlCodServico}&CodigoCidade=${codCidade}`,\r\n\t\t})\r\n\t\t\t.done(function (data) {\r\n\t\t\t\tpickupPoints = slas.filter(sla => sla.Tipo === \"pickup-in-point\").map(pickupPoint => {\r\n\t\t\t\t\tpickupPoint.store = data.Registros.reduce((finalStore, store) => {if(store.Nome.indexOf(pickupPoint.DadosPickupPoint.address.addressId) > -1) finalStore = store; return finalStore}, null )\r\n\t\t\t\t\treturn pickupPoint;\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t$(\".secao-agendamento .qtd\").text(`Lojas próximas: ${pickupPoints.length}`);\r\n\t\t\t\tif (pickupPoints.length === 0)\r\n\t\t\t\t\t$(\".secao-agendamento > .store-list\").append(noTimeAvailable());\r\n\t\t\t\t\r\n\r\n\t\t\t\tpickupPoints.forEach(function (pickupPoint, index) {\r\n\t\t\t\t\t$(\".secao-agendamento > .store-list\").append(populateStore(pickupPoint));\r\n\t\t\t\t\t// if (data.Registros.length - 1 === index) {\r\n\t\t\t\t\t//   $(\".store-info .btn-ver-horarios:not(.danger)\").click(function () {\r\n\t\t\t\t\t//     $(this).parent().next().toggleClass(\"hidden\");\r\n\t\t\t\t\t//   });\r\n\t\t\t\t\t// }\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$('.timestamp').click(function (e) {\r\n\t\t\t\t\tif (window.location.href.includes('checkout')) {\r\n\t\t\t\t\t\t$('body').removeClass('mz-bo-on mz-as-on mz-il-on');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$('.mz-install__button--buy').click(e => e.preventDefault());\r\n\r\n\t\t\t\t\tconst loja = $(this).attr('data-store');\r\n\t\t\t\t\tconst cep = $(this).attr('data-cep');\r\n\t\t\t\t\tconst horario = $(this).html();\r\n\t\t\t\t\tconst date = $(\".secao-agendamento .data input\")\r\n\t\t\t\t\t\t.datepicker(\"getDate\")\r\n\t\t\t\t\t\t.toISOString()\r\n\t\t\t\t\t\t.split(\"T\")[0];\r\n\r\n\t\t\t\t\tlocalStorage.setItem('AG_SelectedHour', JSON.stringify({\r\n\t\t\t\t\t\tloja,\r\n\t\t\t\t\t\thorario,\r\n\t\t\t\t\t\tdate,\r\n\t\t\t\t\t\t_createAt: Date.now()\r\n\t\t\t\t\t}));\r\n\r\n\t\t\t\t\t$('.store .time .time-list button').removeClass('selected')\r\n\t\t\t\t\t$(e.srcElement).addClass('selected');\r\n\r\n\t\t\t\t\tvtexjs.checkout.calculateShipping({\r\n\t\t\t\t\t\tpostalCode: cep,\r\n\t\t\t\t\t\tcountry: 'BRA',\r\n\t\t\t\t\t\taddressType: 'search'\r\n\t\t\t\t\t}).then((order) => { forceChangeShipping(order); $('.mz-install__button--buy').unbind('click'); });\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.fail(() =>\r\n\t\t\t\t$(\".secao-agendamento > .store-list\").append(noTimeAvailable())\r\n\t\t\t);\r\n\r\n\t\t$(\".store-info .btn-ver-horarios:not(.danger)\").click(function () {\r\n\t\t\t$(this).parent().next().toggleClass(\"hidden\");\r\n\t\t});\r\n\t}\r\n\r\n\tfunction populateStore(pickupPoint) {\r\n\t\tconst store = pickupPoint.store;\r\n\t\tconst dadosEndereco = pickupPoint.DadosPickupPoint.address;\r\n\t \r\n\t\treturn `\r\n\t\t\t<div id=\"${dadosEndereco.addressId}\" class=\"pickup\">\r\n\t\t\t\t<div class=\"pickup__info\">\r\n\t\t\t\t\t<div class=\"pickup__info-distance\">\r\n\t\t\t\t\t\t<svg class=\"pkpmodal-pickup-point-best-marker-image\" width=\"25\" height=\"32\" viewBox=\"0 0 25 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n\t\t\t\t\t\t\t<path d=\"M19.4917 22.3169L19.4918 22.3169L19.4967 22.3096C19.5843 22.1782 19.6709 22.0485 19.7564 21.9204C22.0478 18.4883 23.5645 16.2165 23.5645 12.5323C23.5645 6.16317 18.4013 1 12.0323 1C5.66317 1 0.5 6.16317 0.5 12.5323C0.5 16.5417 3.05396 20.5158 5.20313 23.2599C6.56216 24.9952 9.21424 28.1986 11.703 30.3763L12.0323 30.6644L12.3615 30.3763C14.8402 28.2075 16.7075 26.3386 19.4917 22.3169Z\" fill=\"#2D78F6\" stroke=\"white\"></path>\r\n\t\t\t\t\t\t\t<path d=\"M18.6968 9.73418L14.6509 9.14642L12.8407 5.48019C12.5239 4.83994 11.4759 4.83994 11.159 5.48019L9.3498 9.14642L5.30298 9.73418C4.53711 9.84573 4.22682 10.7906 4.78365 11.3344L7.71213 14.1878L7.02126 18.2178C6.89096 18.9808 7.69338 19.5667 8.38145 19.2058L11.9999 17.3038L15.6192 19.2068C16.3017 19.5639 17.1107 18.9874 16.9794 18.2187L16.2885 14.1888L19.217 11.3353C19.7729 10.7906 19.4626 9.84573 18.6968 9.73418Z\" fill=\"white\"></path>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t<p>${pickupPoint.Distancia.toFixed(1)} km</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"pickup__info-address\">\r\n\t\t\t\t\t\t<div class=\"address-title\">\r\n\t\t\t\t\t\t\t<b>${pickupPoint.DadosPickupPoint.friendlyName}</b>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p class=\"address-location\">\r\n\t\t\t\t\t\t\t${dadosEndereco.street} ${dadosEndereco.number},\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<p class=\"pickup__info-city\">${dadosEndereco.neighborhood} - ${dadosEndereco.city} - ${dadosEndereco.state}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\r\n\t\t<div class=\"time\">\r\n\t\t\t<p>Horários:</p>\r\n\t\t\t<div class=\"time-list\">\r\n\t\t\t${createTimestampList(store.Horarios, `${store.Nome} | ${store.Bairro}`, store.Cep).join(\"\\n\")}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tfunction createTimestampList(horarios, store, cep) {\r\n\t\treturn horarios.map(function (horario) {\r\n\t\t\tlet timestamp = new Date(horario.HoraInicial);\r\n\t\t\treturn horario.Disponibilidade.Value !== \"Nao\"\r\n\t\t\t\t? `<button data-store=\"${store}\" data-cep=\"${cep}\" class=\"timestamp\">${timestamp.toLocaleTimeString([], {\r\n\t\t\t\t\thour: \"2-digit\",\r\n\t\t\t\t\tminute: \"2-digit\",\r\n\t\t\t\t})}</button>`\r\n\t\t\t\t: \"\";\r\n\t\t});\r\n\t}\r\n\r\n\tfunction noTimeAvailable() {\r\n\t\treturn `<div id=\"sem-lojas\" style=\"\r\n\t\t\tmin-height: 100px;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\tjustify-content: space-evenly;\">\r\n\t\t\t<p style=\"text-align: center;\">\r\n\t\t\t\tNão encontramos horários de instalação disponíveis para essa data.\r\n\t\t\t</p>\r\n\t\t\t<small style=\"text-align: center;\">\r\n\t\t\t\tPor favor, tente outras datas ou fale com nossos consultores no chat.\r\n\t\t\t</small>\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tfunction forceChangeShipping(orderForm) {\r\n\t\tconst newSelectedAddresses = [orderForm.shippingData.availableAddresses[orderForm.shippingData.availableAddresses.length - 1]];\r\n\t\tconst logistic = orderForm.shippingData.logisticsInfo[0];\r\n\r\n\t\tif (logistic) {\r\n\t\t\tconst slas = logistic.slas.filter(x => x.deliveryChannel === 'pickup-in-point');\r\n\t\t\tconst logisticsInfo = orderForm.shippingData.logisticsInfo.map(x => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\taddressId: newSelectedAddresses[0].addressId,\r\n\t\t\t\t\titemIndex: x.itemIndex,\r\n\t\t\t\t\tselectedDeleveryChannel: 'pickup-in-point',\r\n\t\t\t\t\tselectedSla: slas[0].id\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tfetch(`/api/checkout/pub/orderForm/${orderForm.orderFormId}/attachments/shippingData`, {\r\n\t\t\t\tmethod: 'post',\r\n\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\tclearAddressIfPostalCodeNotFound: false,\r\n\t\t\t\t\texpectedOrderFormSections: ['shippingData'],\r\n\t\t\t\t\tselectedAddresses: newSelectedAddresses,\r\n\t\t\t\t\tlogisticsInfo\r\n\t\t\t\t})\r\n\t\t\t}).then(res => res.json()).then(x => {\r\n\t\t\t\tvtexjs.checkout.sendAttachment('shippingData', {\r\n\t\t\t\t\tselectedAddresses: newSelectedAddresses,\r\n\t\t\t\t\tlogisticsInfo\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Instale em Casa\r\n$(function () {\r\n\tconst baseUrlApi = window.location.href.includes(\"dev\")\r\n\t\t? \"https://api-hml.autoglass.com.br/integracao-b2c/api/web-app/\"\r\n\t\t: \"https://api.autoglass.com.br/integracao-b2c/api/web-app/\";\r\n\r\n\tlet event = new Event('datepicker_carregado');\r\n\r\n\tlet AvailableDays;\r\n\tlet isLoading = false;\r\n\r\n\tlet minDate = new Date();\r\n\tminDate.setDate(minDate.getDate() + 2);\r\n\tlet maxDate = new Date();\r\n\tmaxDate = new Date(minDate.getFullYear(), minDate.getMonth() + 2, 0);\r\n\r\n\t$('.mz-advantages__content .cep  input').mask('99999-999').val('');\r\n\r\n\t$('#mostrar-datas-datepicker').datepicker({\r\n\t\tdateFormat: \"dd/mm/yy\",\r\n\t\tshowAnim: 'slideDown',\r\n\t\tnumberOfMonths: $(document).width() < 650 ? 1 : 2,\r\n\t\tdayNamesMin: [\"D\", \"S\", \"T\", \"Q\", \"Q\", \"S\", \"S\"],\r\n\t\tmonthNames: [\r\n\t\t\t\"Janeiro\",\r\n\t\t\t\"Fevereiro\",\r\n\t\t\t\"Março\",\r\n\t\t\t\"Abril\",\r\n\t\t\t\"Maio\",\r\n\t\t\t\"Junho\",\r\n\t\t\t\"Julho\",\r\n\t\t\t\"Agosto\",\r\n\t\t\t\"Setembro\",\r\n\t\t\t\"Outubro\",\r\n\t\t\t\"Novembro\",\r\n\t\t\t\"Dezembro\",\r\n\t\t],\r\n\t\tminDate,\r\n\t\tmaxDate,\r\n\t\tonSelect: (selectedDay, infos) => {\r\n\t\t\tlocalStorage.setItem('AG_SelectedDaySM', JSON.stringify({\r\n\t\t\t\tselectedDay,\r\n\t\t\t\tinfos,\r\n\t\t\t\t_createAt: Date.now()\r\n\t\t\t}));\r\n\r\n\t\t\t$('.preview-data').fadeOut(500, () => {\r\n\t\t\t\t$('.preview-data b').html(selectedDay);\r\n\t\t\t\t$('.preview-data').fadeIn(500);\r\n\t\t\t});\r\n\r\n\t\t\t$.get('/').then();\r\n\t\t},\r\n\t\tbeforeShowDay: validadeAvailableDays\r\n\t});\r\n\r\n\t$('#input-cep-btn').click(Carregar);\r\n\r\n\tconst address = JSON.parse(localStorage.getItem('AG_AddressSelected'));\r\n\r\n\tif (address) {\r\n\t\tgetDeliveriesEstimates(address.postalCode, undefined, undefined)\r\n\t\t\t.then((datas) => {\r\n\t\t\t\tsetDateDatepicker(datas);\r\n\t\t\t\tCarregar(address.postalCode);\r\n\t\t\t});\r\n\t} else {\r\n\t\t// Evento lançado pelo componente de cep\r\n\t\t$(window).on('cep-finish-load', async (e) => {\r\n\t\t\tconst orderForm = e.originalEvent.detail;\r\n\t\t\tconst dates = await getDeliveriesEstimates(\r\n\t\t\t\torderForm.shippingData.address.postalCode,\r\n\t\t\t\torderForm.shippingData.logisticsInfo,\r\n\t\t\t\torderForm.items\r\n\t\t\t);\r\n\t\t\tsetDateDatepicker(dates);\r\n\t\t\tCarregar(orderForm.shippingData.address.postalCode);\r\n\t\t});\r\n\t}\r\n\r\n\t// Evento lançado pelo componente de cep\r\n\t$(window).on('cep-updated', async (e) => {\r\n\t\tconst orderForm = e.originalEvent.detail;\r\n\t\tconst dates = await getDeliveriesEstimates(\r\n\t\t\torderForm.shippingData.address.postalCode,\r\n\t\t\torderForm.shippingData.logisticsInfo,\r\n\t\t\torderForm.items\r\n\t\t);\r\n\t\tsetDateDatepicker(dates);\r\n\t\tCarregar(orderForm.shippingData.address.postalCode);\r\n\t});\r\n\r\n\tfunction setDateDatepicker(datas) {\r\n\t\tconst minDate = datas.find(x => x.Nome.trim().toLocaleLowerCase() === 'Autoglass Móvel'.trim().toLocaleLowerCase());\r\n\r\n\t\tmaxDate = new Date(minDate.Data.getFullYear(), minDate.Data.getMonth() + 2, 0);\r\n\r\n\t\t$('#mostrar-datas-datepicker').datepicker('option', 'maxDate', maxDate);\r\n\t\t$('#mostrar-datas-datepicker').datepicker('option', 'minDate', minDate.Data);\r\n\t}\r\n\r\n\tasync function Carregar(cep) {\r\n\t\t$('#aviso-servico-movel').hide();\r\n\t\t$('.preview-data').hide();\r\n\r\n\t\tif (cep && !isLoading) {\r\n\t\t\tisLoading = true;\r\n\t\t\t$('.datas-disponiveis').show();\r\n\t\t\t$('.loading-dates').show();\r\n\t\t\t$('#mostrar-datas-datepicker').css('height', '0px');\r\n\r\n\t\t\tconst request = {\r\n\t\t\t\tCep: cep,\r\n\t\t\t\tDataInicio: minDate.toISOString().split(\"T\")[0],\r\n\t\t\t\tDataFim: maxDate.toISOString().split(\"T\")[0],\r\n\t\t\t\tCarrinho: [],\r\n\t\t\t\tTipoDocumento: 'Venda',\r\n\t\t\t\tTipoServico: 'Instalacao',\r\n\t\t\t\tQt: 100\r\n\t\t\t}\r\n\r\n\t\t\t// skuJson only exists on Produtc Detail Page\r\n\t\t\tif (window.skuJson) {\r\n\t\t\t\trequest.Carrinho.push(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tCodigoProduto: +window.skuJson.name.match(/\\d+$/)[0],\r\n\t\t\t\t\t\tQuantidade: 1\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tlet order;\r\n\r\n\t\t\t\tif (window.location.href.includes('orderPlaced')) {\r\n\t\t\t\t\t// Only will work on Confirmation\r\n\t\t\t\t\torder = await getOrderForm();\r\n\t\t\t\t} else {\r\n\t\t\t\t\torder = await vtexjs.checkout.getOrderForm();\r\n\t\t\t\t}\r\n\r\n\t\t\t\trequest.Carrinho = order.items\r\n\t\t\t\t\t.filter(item => item.additionalInfo.brandId !== \"2000108\")\r\n\t\t\t\t\t.map(item => (\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tCodigoProduto: +item.productRefId,\r\n\t\t\t\t\t\t\tQuantidade: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t));\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await getAvailableDays(request);\r\n\r\n\t\t\t\tAvailableDays = response.Registros.map(x => ({\r\n\t\t\t\t\t...x,\r\n\t\t\t\t\tDataRoteiro: new Date(x.DataRoteiro)\r\n\t\t\t\t}));\r\n\r\n\t\t\t\tif (response.Registros.filter(x => x.Disponivel === false).length === response.Registros.length) {\r\n\t\t\t\t\t$('#aviso-servico-movel')\r\n\t\t\t\t\t\t.show()\r\n\t\t\t\t\t\t.html(`\r\n\t\t\t\t\t\t\tInstalação em Casa indisponível para sua região. Tente alterar o CEP ou\r\n\t\t\t\t\t\t\t<a onclick=\"$zopim.livechat.window.show()\"><b> clique aqui </b></a>\r\n\t\t\t\t\t\t\te fale com a gente pelo chat.\r\n\t\t\t\t\t\t`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$('#mostrar-datas-datepicker').datepicker('setDate', minDate);\r\n\t\t\t\t\t$('#mostrar-datas-datepicker').datepicker('refresh');\r\n\t\t\t\t\t$('a.ui-state-active').removeClass('ui-state-active');\r\n\t\t\t\t\t$('a.ui-state-hover').removeClass('ui-state-hover');\r\n\r\n\t\t\t\t\t$('#mostrar-datas-datepicker').css('height', '270px');\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tlet message;\r\n\r\n\t\t\t\tswitch (err.status) {\r\n\t\t\t\t\tcase 400:\r\n\t\t\t\t\t\tmessage = (JSON.parse(err.responseText)).Message;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tmessage = 'Não encontramos atendimento para este CEP. Mas procure a gente no chat para te ajudar!'\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$('#aviso-servico-movel')\r\n\t\t\t\t\t.show()\r\n\t\t\t\t\t.html(message);\r\n\t\t\t} finally {\r\n\t\t\t\tisLoading = false;\r\n\t\t\t\t$('.loading-dates').hide();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\twindow.dispatchEvent(event);\r\n\r\n\tfunction getAvailableDays(request) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t$.ajax({\r\n\t\t\t\tcontentType: \"application/json\",\r\n\t\t\t\tcrossDomain: true,\r\n\t\t\t\tjsonp: false,\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\turl: `${baseUrlApi}agendamentos/servicos-moveis/disponibilidades`,\r\n\t\t\t\tdata: JSON.stringify(request),\r\n\t\t\t\tsuccess: function (data) {\r\n\t\t\t\t\tresolve(data)\r\n\t\t\t\t},\r\n\t\t\t\terror: function (error) {\r\n\t\t\t\t\treject(error)\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tfunction getOrderForm() {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t$.ajax({\r\n\t\t\t\tjsonp: false,\r\n\t\t\t\turl: `/api/checkout/pub/orders/${$(\"#order-id\").text().trim()}`,\r\n\t\t\t\tcontentType: \"application/json\",\r\n\t\t\t\ttype: \"GET\",\r\n\t\t\t\tsuccess: function (data) {\r\n\t\t\t\t\tresolve(data)\r\n\t\t\t\t},\r\n\t\t\t\terror: function (error) {\r\n\t\t\t\t\treject(error)\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\tfunction validadeAvailableDays(date) {\r\n\t\tconst isSunday = date.toDateString().includes(\"Sun\");\r\n\t\tconst isSaturday = date.toDateString().includes(\"Sat\");\r\n\r\n\t\tif (isSunday || isSaturday) {\r\n\t\t\treturn [false];\r\n\t\t}\r\n\r\n\t\tif (AvailableDays) {\r\n\t\t\tconst day = AvailableDays.find(x => x.DataRoteiro.toLocaleDateString() === date.toLocaleDateString());\r\n\r\n\t\t\tif (day) {\r\n\t\t\t\treturn day.Disponivel ? [true] : [false];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn [false];\r\n\t}\r\n});\r\n\r\nasync function getDeliveriesEstimates(postalCode, logistics, items) {\r\n\tconst isConfirmationPage = location.href.includes('orderPlaced');\r\n\tconst isCheckoutPage = location.href.includes('checkout');\r\n\tconst hasCartItems = items && items.length;\r\n\r\n\tconst buildSimulationItems = (items) => items.map(i => ({\r\n\t\tquantity: i.quantity,\r\n\t\tseller: i.seller,\r\n\t\tid: i.id\r\n\t}));\r\n\r\n\tlet simulationItems = [];\r\n\r\n\ttry {\r\n\t\tif (isConfirmationPage && hasCartItems) {\r\n\t\t\tconst orderForm = await $.get(`/api/checkout/pub/orders/${$(\"#order-id\").text().trim()}`);\r\n\t\t\tsimulationItems = buildSimulationItems(orderForm.items);\r\n\t\t} else if (isCheckoutPage && hasCartItems) {\r\n\t\t\tsimulationItems = buildSimulationItems(items);\r\n\t\t} else {\r\n\t\t\t// 12685 -> Produto de Instalação\r\n\t\t\tconst installmentProduct = await vtexjs.catalog.getProductWithVariations(12685);\r\n\t\t\tconst currentProduct = await vtexjs.catalog.getCurrentProductWithVariations();\r\n\r\n\t\t\tsimulationItems = [\r\n\t\t\t\t{\r\n\t\t\t\t\tquantity: 1,\r\n\t\t\t\t\tseller: currentProduct.skus[0].sellerId,\r\n\t\t\t\t\tid: currentProduct.skus[0].sku\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tquantity: 1,\r\n\t\t\t\t\tseller: installmentProduct.skus[0].sellerId,\r\n\t\t\t\t\tid: installmentProduct.skus[0].sku\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\tconst { logisticsInfo } = await $.ajax({\r\n\t\t\ttype: 'POST',\r\n\t\t\turl: '/api/checkout/pub/orderForms/simulation',\r\n\t\t\tdataType: 'json',\r\n\t\t\tcontentType: 'application/json',\r\n\t\t\tdata: JSON.stringify({\r\n\t\t\t\tcountry: 'BRA',\r\n\t\t\t\titems: simulationItems,\r\n\t\t\t\tpostalCode\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t\tconst logistic = logisticsInfo && logisticsInfo.length\r\n\t\t\t? logisticsInfo[0]\r\n\t\t\t: logistics[0];\r\n\r\n\t\tif (logistic) {\r\n\t\t\tconst slas = logistic.slas.map(sla => {\r\n\t\t\t\tconst estimate = sla.shippingEstimate;\r\n\t\t\t\tconst numberOfDays = +estimate.replace('bd', '');\r\n\r\n\t\t\t\tconst today = new Date();\r\n\t\t\t\tconst shippingEstimate = new Date();\r\n\r\n\t\t\t\tshippingEstimate.setDate(today.getDate() + numberOfDays);\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tData: shippingEstimate,\r\n\t\t\t\t\tNome: sla.id,\r\n\t\t\t\t\tTipo: sla.deliveryChannel,\r\n\t\t\t\t\tDadosPickupPoint: sla.pickupStoreInfo,\r\n\t\t\t\t\tDistancia: sla.pickupDistance,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn slas;\r\n\t\t}\r\n\t} catch (ex) {\r\n\t\tconsole.error('Falha ao calcular o tempo de entrega!', ex);\r\n\t\treturn new Date();\r\n\t}\r\n}\n\n//# sourceURL=webpack:///./src/js/consulta-agendamento.dev.js?");

/***/ })

/******/ });