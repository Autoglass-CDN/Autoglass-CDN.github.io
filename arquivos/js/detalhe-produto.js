const baseUrlApi=window.location.href.includes("dev")||window.location.href.includes("mvp")||window.location.href.includes("hml")?"https://api-hml.autoglass.com.br/integracao-b2c/api/web-app":"https://api.autoglass.com.br/integracao-b2c/api/web-app",sections=[...document.querySelectorAll("section.tab-content")],getLinkById=e=>document.querySelector(`a[href='#${e}'].tab-link`);function handleSocialClick(e,t){dataLayer.push({event:"share",method:t,content_type:skuJson.skus[0].image,item_id:skuJson.skus[0].sku})}$(".product-qd-v1-buy-button .buy-button.buy-button-ref").addClass("add-to-cart-ga");const socialMediaElements={whatsapp:".product-qd-v1-social-share.desktop .whatsapp",twitter:".product-qd-v1-social-share.desktop .twitter",mail:".product-qd-v1-social-share.desktop .mail",facebook:".product-qd-v1-social-share.desktop .facebook"};function exibeNumeroVendas(){let e,t=recuperarNumeroVendas();null!=t&&t.then(function(t){e=window.innerWidth<900?document.querySelector(".numero-vendas-mobile"):document.querySelector(".numero-vendas"),t>10&&(e.innerHTML=`
  <div class="vendas-wrapper">
    <i class="fa fa-shopping-bag"></i>
    <span class="texto-numero-vendas">${t}</span>
    <span class="texto-vendidos">vendidos</span>
  </div>
  `)})}function ButtoWhatsappClick(e,t){dataLayer.push({event:"whatsapp",position:t})}Object.entries(socialMediaElements).forEach(([e,t])=>{let o=document.querySelector(t);o.addEventListener("click",t=>handleSocialClick(t,e))});const whatsappElements={".link-whatsapp-texto.link-whatsapp-conteudo-sem-numero":"topo",".link-whatsapp-texto.gtm-whatsapp-botao-rodape":"widget",".link-whatsapp-texto.botao-compre-whatsapp":"compre-whatsapp",".link-whatsapp-texto.link-whatsapp":"footer"};Object.entries(whatsappElements).forEach(([e,t])=>{let o=document.querySelector(e);o&&o.addEventListener("click",e=>ButtoWhatsappClick(e,t))});let veiculosBuscaveis=[];const sugestoesContainer=$(".veiculos-compativeis-search__search-suggestions");$(".veiculos-compativeis-search").hide();const inView=(e,t)=>{let o=e.offsetTop,a=e.offsetHeight;for(;e.offsetParent;)o+=(e=e.offsetParent).offsetTop;return t&&(o-=t>1200?250:130),o<window.pageYOffset+window.innerHeight&&o+a>window.pageYOffset};window.onscroll=()=>{let e=!1;sections.forEach(t=>{let o=getLinkById(t.id);inView(t,window.innerWidth)&&!e?(o.classList.add("tab--current"),e=!0):o&&o.classList.remove("tab--current")})};const toggleSectionCollapse=e=>{e.classList.toggle("ativo")},sectionCollapseInit=()=>{document.querySelectorAll(".contents .tab-content h2").forEach(e=>{e.onclick=()=>{toggleSectionCollapse(e.closest(".tab-content"))},("Compre Junto"===e.textContent||"Outras Marcas"===e.textContent)&&setTimeout(()=>toggleSectionCollapse(e.closest(".tab-content")),5e3)})};async function insertBrandDescription(){return fetch("/api/catalog_system/pub/brand/list").then(e=>e.json()).then(e=>{let t=document.querySelector(".brandName").classList.value.replace("brandName","").trim().replace("-"," ").split(" ")[0],o=e.find(e=>e.name.includes(t));if(o&&""!==o.metaTagDescription){let a=o.metaTagDescription,s=document.querySelector("#descricao-marca");s.textContent=a,s.parentElement.parentElement.style.display="block"}})}async function getProductRefIdByProductName(){let e=await vtexjs.catalog.getCurrentProductWithVariations();try{let[t,o]=e.name.match(/(\d+)(\s?\-?\s?[0-9]+)?$/);return o}catch(a){return 0}}async function buscaPorPlaca(e){var t;let o=(t=e,t.trim().replace(/[\W_]+/g,"").toUpperCase());try{window.innerWidth<700&&(document.querySelector("#side-menu .loading-overlay").style.display="block");let{montadora:a,modelo:s,anoModelo:i,fipe:c}=await l(o);return{montadora:a,modelo:s,anoModelo:i,fipe:c}}catch(n){}async function l(e){let t=await fetch(`${baseUrlApi}/veiculos/${e}/placas`),o=await t.json();return montadora=o.Body.Data.Marca,modelo=o.Body.Data.Modelo,anoModelo=o.Body.Data.DadosBasicosDoVeiculo.AnoModelo,fipe=o.Body.Data.DadosBasicosDoVeiculo.InformacoesFipe[0].FipeId,{montadora,modelo,anoModelo,fipe}}}async function recuperarNumeroVendas(){return await $.get(`${baseUrlApi}/vendas/vendas/${parseInt(await getProductRefIdByProductName())}`)}async function buscarPromocoes(){try{let e=await fetch(`${baseUrlApi}/promocoes?nome=pix`),t=await e.json(),o=t.find(e=>e.isActive);if(o)aplicarDesconto(o.percentualDiscountValue);else{let a=document.querySelectorAll(".skuBestPrice");a.forEach(e=>{e.style.display="inline-block"})}}catch(s){let i=document.querySelectorAll(".skuBestPrice");i.forEach(e=>{e.style.display="inline-block"})}}function aplicarDesconto(e){let t=document.querySelectorAll(".skuListPrice")[1],o=parseFloat(t.innerHTML.trim().replace("R$","").trim().replace(".","").replace(",",".")),a=document.querySelectorAll(".skuBestPrice");a.forEach((t,s)=>{let i=t.textContent.trim();i=(i=i.replace("R$","").trim()).replace(".","").replace(",",".");let c=parseFloat(i);if(!isNaN(c)){let n=Math.round(100*(Math.round(c*(1-e/100)*1e3)/1e3))/100;if(t.textContent=n.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),t.style.fontSize="18px",s!==a.length-1){let l=document.createElement("div");l.classList.add("pix-discount"),l.textContent="no Pix";let r=document.createElement("div");r.classList.add("percent-box"),r.textContent=`-${Math.round((o-n)/o*100)}%`,t.parentElement.appendChild(l),t.parentElement.appendChild(r)}else{let d=document.createElement("div");d.classList.add("pix-discount"),d.textContent="no Pix",t.parentElement.appendChild(d),t.classList.add(".preco-bottom-mobile")}t.style.display="inline-block",ajustarTextoValorParcelado(c)}})}function ajustarTextoValorParcelado(e){let t=document.querySelectorAll(".valor-dividido.price-installments");t.forEach(function(o,a){let s=null!==o.closest(".product-qd-v1-fixed-bar");if(!o.classList.contains("modificada")){if(o.classList.add("modificada"),s){o.style.fontWeight="normal",o.style.setProperty("font-weight","normal","important"),o.style.color="#2d4f9e";o.querySelectorAll(".skuBestInstallmentNumber").forEach(e=>{if(/^\d+\s*x\s*$/i.test(e.textContent.trim())){let t=e.closest("span"),o=t.parentNode,a=!1;[...o.childNodes].forEach(e=>{a&&o.removeChild(e),(e===t||1===e.nodeType&&e.contains(t))&&(a=!0,[...t.childNodes].forEach(e=>{e.nodeType===Node.TEXT_NODE&&e.textContent.includes("de")&&(e.textContent="")}))})}})}let i=o.querySelector(".skuBestInstallmentNumber"),c=document.createElement("label");if(c.textContent=e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),c.classList.add("skuBestInstallmentNumber"),i){i.parentNode.insertBefore(c,i);let n=document.createElement("span");n.textContent=" em ",n.classList.add("palavras-conectivas"),c.parentNode.insertBefore(n,i);let l=document.createElement("span");l.textContent=" sem juros",l.classList.add("span-sem-juros");let r=o.querySelector("strong");if(r&&r.appendChild(l),a!==t.length-1&&("none"===o.style.display||"none"===getComputedStyle(o).display)){let d=o.closest(".descricao-preco");if(d){let p=document.createElement("div");p.classList.add("valor-dividido","price-installments","modificada");let u=document.createElement("span");u.textContent="ou ",p.appendChild(u),tipoTag=0===a?"label":"span";let v=document.createElement(tipoTag);v.textContent=c.textContent,v.classList.add("skuBestInstallmentNumber"),p.appendChild(v),d.appendChild(p)}}}}})}sectionCollapseInit(),window.addEventListener("load",insertBrandDescription),$(window).on("load",async()=>{function e(){$(".product-qd-v1-image div#image").css("min-height",$(".product-qd-v1-image #image-main").width())}window.addEventListener("resize",e),e(),y();let t=$("#veiculos-compativeis"),o=await getProductRefIdByProductName(),a;try{a=await $.get(`${baseUrlApi}/produtos/${o}/veiculos-compativeis`)}catch(s){a=[]}veiculosBuscaveis=a;let i=!!a&&a.length>0;if(i){t.html(`
<h2>Ve\xedculos Compat\xedveis</h2>
<div class="veiculos-compativeis__box">
<div class="veiculos-compativeis__box-header">
<button id="group-prev" data-type="prev" type="button">
<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" alt="\xcdcone de seta para a esquerda">
<path id="Icon_ionic-ios-arrow-dropleft-circle" data-name="Icon ionic-ios-arrow-dropleft-circle" d="M19.375,3.375a16,16,0,1,0,16,16A16,16,0,0,0,19.375,3.375Zm3.338,22.238a1.49,1.49,0,0,1,0,2.1,1.467,1.467,0,0,1-1.046.431,1.492,1.492,0,0,1-1.054-.438l-7.231-7.254a1.483,1.483,0,0,1,.046-2.046l7.338-7.362a1.485,1.485,0,0,1,2.1,2.1l-6.3,6.231Z" transform="translate(35.375 35.375) rotate(180)" opacity="0.42"/>
</svg>
</button>
${a.map(p).join("")}
<button id="group-next" data-type="next" type="button">
<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" alt="\xcdcone de seta para a direita">
<path id="Icon_ionic-ios-arrow-dropleft-circle" data-name="Icon ionic-ios-arrow-dropleft-circle" d="M19.375,3.375a16,16,0,1,0,16,16A16,16,0,0,0,19.375,3.375Zm3.338,22.238a1.49,1.49,0,0,1,0,2.1,1.467,1.467,0,0,1-1.046.431,1.492,1.492,0,0,1-1.054-.438l-7.231-7.254a1.483,1.483,0,0,1,.046-2.046l7.338-7.362a1.485,1.485,0,0,1,2.1,2.1l-6.3,6.231Z" transform="translate(35.375 35.375) rotate(180)" opacity="0.42"/>
</svg>
</button>
</div>
<div class="veiculos-compativeis__box-content">
${a.map(v).join("")}
</div>
</div>
`),$(".veiculos-compativeis__header-option").first().addClass("active"),$(".veiculos-compativeis__box-content div").first().addClass("active"),$(".veiculos-compativeis__header-option").click(function(){$(".veiculos-compativeis__header-option").removeClass("active"),$(this).addClass("active"),$(".veiculos-compativeis__box-content div").removeClass("active"),$(`.veiculos-compativeis__box-content div[data-for="${$(this).attr("id")}"]`).addClass("active")}),$("#veiculos-compativeis .veiculos-compativeis__box .veiculos-compativeis__box-header button").click(function(){let e=$(this).attr("data-type"),t=$("#veiculos-compativeis .veiculos-compativeis__box .veiculos-compativeis__box-header");"next"===e?t[0].scrollBy(200,0):t[0].scrollBy(-200,0)});let c=$("#veiculos-compativeis .veiculos-compativeis__box .veiculos-compativeis__box-header");$("#veiculos-compativeis h2").click(()=>toggleSectionCollapse(t[0])),h(c),c.on("scroll",function(){h($(this))}),$(window).on("resize",function(){h(c)}),$(".veiculos-compativeis-search").show()}else $('a[href="#veiculos-compativeis"]').parent().hide(),t.hide();let n=Product.captureSkuSelectors(),l="/checkout/cart/add?sku="+n[0]+"&qty=1&seller=1&redirect=true&"+readCookie("VTEXSC");async function r(e){let t;if(e.trim().match(/^[A-Z]{3}[\-_]?[0-9][0-9A-Z][0-9]{2}$/i)){sugestoesContainer.html(`
<div class="spinner-compatibilidade"></div>
`);let{modelo:o,anoModelo:a}=await buscaPorPlaca(e.trim());e=o,t=parseInt(a,10),sugestoesContainer.empty()}if(veiculosBuscaveis&&veiculosBuscaveis.length>0&&e.length>0){let s=veiculosBuscaveis.map(o=>o.Veiculos.filter(o=>RegExp(e.split(" ").map(e=>`(?=.*${e})`).join(""),"i").test(o.Veiculo)&&(void 0==t||o.Anos.includes(t)))).filter(e=>e.length>0);s.length?(sugestoesContainer.html(s.flat().slice(0,3).map(d).join("")+`<div class="veiculos-compativeis-search__link">
<a href="#veiculos-compativeis">Ver todos</a>
</div>`),document.querySelectorAll("a.veiculos-compativeis__content-compativel-link").forEach(e=>e.addEventListener("click",u))):sugestoesContainer.html(`
<div class="veiculos-compativeis-search__disclaimer">
Modelo de carro n\xe3o compat\xedvel :(
</div>
<div class="veiculos-compativeis-search__link">
<a href="#veiculos-compativeis">Ver todos</a>
</div>
`)}else sugestoesContainer.empty()}function d(e,t){return`<a href="${l}" class="veiculos-compativeis__content-compativel-link">
<p>${e.Veiculo}</p>
<div>${e.Anos.map(e=>"<span>"+e+"</span>").join(",&nbsp")}.</div>
</a>`}function p(e,t){return`
<div id="${e.Grupo+t}" class="veiculos-compativeis__header-option">
<span>${e.Grupo}</span>
</div>
`}function u(){ga("set","transport","beacon"),ga("send","event","Link SelectCar","Clique","Add ao Carrinho")}function v(e,t){return`
<div data-for="${e.Grupo+t}">
${e.Veiculos.map(e=>`
<div class="veiculos-compativeis__content-compativel">
<p>${e.Veiculo}</p>
<div>${e.Anos.map(e=>"<span>"+e+"</span>").join(",&nbsp")}.</div>
</div>
`).join("")}
</div>
`}function h(e){let t=$("#veiculos-compativeis .veiculos-compativeis__box .veiculos-compativeis__box-header button");if(m()){let o=f(e[0]);0===o?(t.last().css("display","flex"),t.first().css("display","none")):100===o?(t.first().css("display","flex"),t.last().css("display","none")):t.css("display","flex")}else t.css("display","none")}function m(){return document.querySelector(".veiculos-compativeis__box-header").scrollWidth>window.innerWidth}function f(e){return 100*e.scrollLeft/(e.scrollWidth-e.clientWidth)}function y(){let e=encodeURIComponent(location.href);$(".product-qd-v1-social-share a.whatsapp").attr("href",`https://api.whatsapp.com/send?text=${e}`),$(".product-qd-v1-social-share a.twitter").attr("href",`https://twitter.com/intent/tweet?text=${e}`),$(".product-qd-v1-social-share a.mail").attr("href",`mailto:?subject=Quero%20compartilhar%20um%20produto%20da%20Autoglass&body=Veja%20este%20produto%20na%20Autoglass:%0D%0A${e}`),$(".product-qd-v1-social-share a.messenger").attr("href",`fb-messenger://share?link=${e}`),$(".product-qd-v1-social-share a.facebook").attr("href",`https://www.facebook.com/sharer.php?u=${e}`),$(".product-qd-v1-social-share a.popup-trigger").click(e=>{e.preventDefault(),$("div.product-qd-v1-social-share-options-popup").fadeToggle(400,"swing",()=>{$(".product-qd-v1-social-share a.copy").children("i.fas.fa-check").attr("class","far fa-copy")})}),$(".product-qd-v1-social-share a.copy").click(e=>{e.preventDefault(),navigator.clipboard.writeText(location.href),$(".product-qd-v1-social-share a.copy").children("i.far.fa-copy").fadeOut("fast").attr("class","fas fa-check").fadeIn("fast")}),$(".product-qd-v1-social-share a:not(.popup-trigger)").click(e=>{let t=$(e.target).closest("a").attr("class"),o=t.replace("_","").split(" ");for(let a=0;a<o.length;a++)o[a]=o[a].charAt(0).toUpperCase()+o[a].slice(1);let s=o.join(" ");ga("create","UA-133498560-1","autoglassonline.com","gaSSTracker"),ga("gaSSTracker.set","transport","beacon"),ga("gaSSTracker.send","event","Social Share",`Compartilhar ${s}`,`Bot\xe3o ${s}`)})}$(".veiculos-compativeis-search__search-box .veiculos-compativeis-search__search-input input").on("input",async function(){await r($(this).val())});let _=null,b=null,g=document.querySelectorAll(".info-acessorios-ag");g.forEach(e=>{let t=e.querySelector("#nome-produto-acessorio-ag")?.textContent?.toUpperCase();t?.includes("INSUMO")&&(_=e.querySelector("#codigo-sku-acessorio-ag")?.textContent?.trim(),b=e.querySelector("#preco-acessorios-ag")?.textContent?.replace("R$","")?.trim())}),$(".product-qd-v1-buy-button .buy-button").attr("href","#");let k="/checkout/cart/add?sku="+n[0]+"&qty=1&seller=1&redirect=true&"+readCookie("VTEXSC"),x=k+"&sku="+_+"&qty=1&seller=1&redirect=true&"+readCookie("VTEXSC");b&&_||$(".card-instalacao").hide(),$(".product-qd-v1-buy-button .buy-button").click(function(){b&&_?window.location.href=x:window.location.href=k}),$(document).ready(function(){$(".botao-compre-whatsapp").click(function(){let e=`Ol\xe1, estou na p\xe1gina desse produto e gostaria de compr\xe1-lo: ${window.location.href}`;window.open(urlWhatsAppApi+numeroWhatsAppAG+"?text="+e,"_blank").focus()})})}),document.addEventListener("DOMContentLoaded",function(){if(exibeNumeroVendas(),window.innerWidth<=1024){function e(){let e=document.querySelector(".teste-opcionais"),t=e.querySelectorAll(".lista-opcionais");if(0===t.length)e.style.setProperty("display","none","important");else if(e.style.setProperty("display","block","important"),t.length>4)for(let o=4;o<t.length;o++)t[o].style.display="none";else for(let a=0;a<t.length;a++)t[a].style.display="block"}(function t(){let o=document.querySelector(".teste-opcionais"),a=o.querySelectorAll(".lista-opcionais");0===a.length?o.style.setProperty("display","none","important"):e()})(),function t(){let o=document.querySelector(".teste-opcionais"),a=new MutationObserver(function(t){t.forEach(function(t){if("childList"===t.type){let a=o.querySelectorAll(".lista-opcionais");0===a.length?o.style.setProperty("display","none","important"):e()}})});a.observe(o,{childList:!0,subtree:!0})}()}}),buscarPromocoes(),$(document).ready(function(){let e=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"hs-web-interactives-top-anchor"===e.id&&$(e).css("display","none"),("hs-interactives-modal-overlay"===e.id||"hs-overlay-cta-191868118043"===e.id)&&$("#"+e.id).css("display","none")}),$("body").hasClass("go1432718904")&&$("body").removeClass("go1432718904")})});e.observe(document.body,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["class"]})});