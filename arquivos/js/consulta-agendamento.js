!function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t){var a={SE:{code:"8529",nome:"Sergipe"},TO:{code:"9654",nome:"Tocantins"},BA:{code:"981",nome:"Bahia"},ES:{code:"1974",nome:"Espírito Santo"},DF:{code:"1730",nome:"Distrito Federal"},RS:{code:"7778",nome:"Rio Grande do Sul"},RJ:{code:"6808",nome:"Rio de Janeiro"},MT:{code:"4282",nome:"Mato Grosso"},PR:{code:"5916",nome:"Paraná"},MS:{code:"4079",nome:"Mato Grosso do Sul"},GO:{code:"2015",nome:"Goiás"},AL:{code:"107",nome:"Alagoas"},CE:{code:"1320",nome:"Ceará"},PA:{code:"4499",nome:"Pará"},RN:{code:"7040",nome:"Rio Grande do Norte"},SC:{code:"8269",nome:"Santa Catarina"},MA:{code:"2533",nome:"Maranhão"},PI:{code:"5647",nome:"Piauí"},MG:{code:"3631",nome:"Minas Gerais"},PB:{code:"4823",nome:"Paraíba"},AM:{code:"240",nome:"Amazonas"},PE:{code:"5229",nome:"Pernambuco"},SP:{code:"9423",nome:"São Paulo"}};$((function(){const e=window.location.href.includes("dev")?"https://api-hml.autoglass.com.br/integracao-b2c/api/web-app/agendamentos":"https://api.autoglass.com.br/integracao-b2c/api/web-app/agendamentos";let t=a[$.cookie("mzLocationUF")],o=t.code||null;window.location.href.includes("checkout")&&$(window).on("orderFormUpdated.vtex",async(e,n)=>{n.shippingData.address&&n.shippingData.address.state&&(t=a[n.shippingData.address.state],o=t.code||null,$(".store").remove(),await s(n.shippingData.logisticsInfo,n.items),r())});let n=new Date;n.setDate(n.getDate()+1),$(".secao-agendamento > .store-list > .filter > .data input").datepicker({dateFormat:"dd/mm/yy",dayNames:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"],dayNamesMin:["D","S","T","Q","Q","S","S","D"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb","Dom"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],minDate:n,beforeShowDay:e=>[!e.toDateString().includes("Sun")],onSelect:()=>{$(".secao-agendamento > .store-list .store").remove(),$(".secao-agendamento > .store-list #sem-lojas").remove(),r()}}),$(".secao-agendamento > .store-list > .filter > .data input").datepicker("setDate",n),$("#btn-alterar-local-instalacao").click((function(){$(".mz-install__close--button").click(),$("#btn-alterar-open-modal").click()}));const i=JSON.parse(localStorage.getItem("AG_AddressSelected"));if(i){let e;"undefined"!=typeof vtexjs&&vtexjs.checkout&&vtexjs.checkout.orderForm&&vtexjs.checkout.orderForm.items&&(e=vtexjs.checkout.orderForm.items),s(i.logisticsInfo,e).then(r)}else $(window).on("cep-finsh-load",async e=>{const t=e.originalEvent.detail;await s(t.shippingData.logisticsInfo,t.items),r()});async function s(e,t){let a=[];if(t&&t.length)a=t.map(e=>({quantity:e.quantity,seller:e.seller,id:e.id}));else if(location.href.includes("orderPlaced")){a=(await $.get("/api/checkout/pub/orders/"+$("#order-id").text().trim())).items.map(e=>({quantity:e.quantity,seller:e.seller,id:e.id}))}else{const e=await vtexjs.catalog.getCurrentProductWithVariations(),t=await vtexjs.catalog.getProductWithVariations(12685);a=[{quantity:1,seller:e.skus[0].sellerId,id:e.skus[0].sku},{quantity:1,seller:t.skus[0].sellerId,id:t.skus[0].sku}]}const o=await $.ajax({type:"POST",url:"/api/checkout/pub/orderForms/simulation",dataType:"json",contentType:"application/json",data:JSON.stringify({country:"BRA",items:a,postalCode:i.postalCode})});let s=o.logisticsInfo&&o.logisticsInfo.length?o.logisticsInfo[0]:e[0];if(s){let e=s.slas[0];if(e){let t=+e.shippingEstimate.replace("bd",""),a=new Date;n.setDate(a.getDate()+t),$(".secao-agendamento > .store-list > .filter > .data input").datepicker("option","minDate",n),$(".secao-agendamento > .store-list > .filter > .data input").datepicker("refresh"),$(".secao-agendamento > .store-list > .filter > .data input").datepicker("setDate",n)}}}function r(){$.ajax({method:"GET",url:`${e}/horarios-lojas?Data=${$(".secao-agendamento .data input").datepicker("getDate").toISOString().split("T")[0]}&CodigoServico=17&CodigoCidade=${o}`}).done((function(e){$(".secao-agendamento .qtd").text("Lojas encontradas: "+e.Total),0===e.Total&&$(".secao-agendamento > .store-list").append(d()),e.Registros.forEach((function(t,a){$(".secao-agendamento > .store-list").append(function(e){return`<div class="store">\n\t\t<div class="store-info">\n\t\t  <div class="aside">\n\t\t\t<h5 class="store-name">\n\t\t\t  ${e.Nome} | ${e.Bairro}\n\t\t\t</h5>\n\t\t\t<p class="address">\n\t\t\t  ${e.Logradouro.toLowerCase()}, ${e.Bairro.toLowerCase()}, ${e.Cidade.toLowerCase()}, \n\t\t\t  ${e.NumeroResidencial}, ${e.UF}, ${e.Cep}\n\t\t\t</p>\n\t\t  </div>\n\t\t  <button class="btn-ver-horarios ${e.Horarios.filter(e=>"Nao"!==e.Disponibilidade.Value).length>0?"":"danger"}">${e.Horarios.filter(e=>"Nao"!==e.Disponibilidade.Value).length>0?"Ver horários":"Horários indisponíveis"}</button>\n\t\t</div>\n\t\t<div class="time hidden">\n\t\t  <p>Horários:</p>\n\t\t  <div class="time-list">\n\t\t\t${function(e,t,a){return e.map((function(e){let o=new Date(e.HoraInicial);return"Nao"!==e.Disponibilidade.Value?`<button data-store="${t}" data-cep="${a}" class="timestamp">${o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}</button>`:""}))}(e.Horarios,`${e.Nome} | ${e.Bairro}`,e.Cep).join("\n")}\n\t\t  </div>\n\t\t</div>\n\t  </div>`}(t)),e.Registros.length-1===a&&$(".store-info .btn-ver-horarios:not(.danger)").click((function(){$(this).parent().next().toggleClass("hidden")}))})),$(".timestamp").click((function(e){window.location.href.includes("checkout")&&$("body").removeClass("mz-bo-on mz-as-on mz-il-on"),$(".mz-install__button--buy").click(e=>e.preventDefault());const t=$(this).attr("data-store"),a=$(this).attr("data-cep"),o=$(this).html(),n=$(".secao-agendamento .data input").datepicker("getDate").toISOString().split("T")[0];localStorage.setItem("AG_SelectedHour",JSON.stringify({loja:t,horario:o,date:n,_createAt:Date.now()})),$(".store .time .time-list button").removeClass("selected"),$(e.srcElement).addClass("selected"),vtexjs.checkout.calculateShipping({postalCode:a,country:"BRA",addressType:"search"}).then(e=>{!function(e){const t=[e.shippingData.availableAddresses[e.shippingData.availableAddresses.length-1]],a=e.shippingData.logisticsInfo[0];if(a){const o=a.slas.filter(e=>"pickup-in-point"===e.deliveryChannel),n=e.shippingData.logisticsInfo.map(e=>({addressId:t[0].addressId,itemIndex:e.itemIndex,selectedDeleveryChannel:"pickup-in-point",selectedSla:o[0].id}));fetch(`/api/checkout/pub/orderForm/${e.orderFormId}/attachments/shippingData`,{method:"post",body:JSON.stringify({clearAddressIfPostalCodeNotFound:!1,expectedOrderFormSections:["shippingData"],selectedAddresses:t,logisticsInfo:n})}).then(e=>e.json()).then(e=>{vtexjs.checkout.sendAttachment("shippingData",{selectedAddresses:t,logisticsInfo:n})})}}(e),$(".mz-install__button--buy").unbind("click")})}))})).fail(()=>$(".secao-agendamento > .store-list").append(d())),$(".store-info .btn-ver-horarios:not(.danger)").click((function(){$(this).parent().next().toggleClass("hidden")}))}function d(){return'<div id="sem-lojas" style="\n      min-height: 100px;\n      display: flex;\n      flex-direction: column;\n      justify-content: space-evenly;">\n      <p style="text-align: center;">\n        Não encontramos horários de instalação disponíveis para essa data.\n      </p>\n      <small style="text-align: center;">\n        Por favor, tente outras datas ou fale com nossos consultores no chat.\n      </small>\n    </div>'}$(window).on("cep-updated",async e=>{const t=e.originalEvent.detail;await s(t.shippingData.logisticsInfo,t.items),r()}),r()})),$((function(){const e=window.location.href.includes("dev")?"https://api-hml.autoglass.com.br/integracao-b2c/api/web-app/":"https://api.autoglass.com.br/integracao-b2c/api/web-app/";let t,a=new Event("datepicker_carregado"),o=!1,n=new Date;n.setDate(n.getDate()+1);let i=new Date;i=new Date(n.getFullYear(),n.getMonth()+2,0),$(".mz-advantages__content .cep  input").mask("99999-999").val(""),$("#mostrar-datas-datepicker").datepicker({dateFormat:"dd/mm/yy",showAnim:"slideDown",numberOfMonths:$(document).width()<650?1:2,dayNamesMin:["D","S","T","Q","Q","S","S"],monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],minDate:n,maxDate:i,onSelect:(e,t)=>{localStorage.setItem("AG_SelectedDaySM",JSON.stringify({selectedDay:e,infos:t,_createAt:Date.now()})),$(".preview-data").fadeOut(500,()=>{$(".preview-data b").html(e),$(".preview-data").fadeIn(500)}),$.get("/").then()},beforeShowDay:function(e){const a=e.toDateString().includes("Sun"),o=e.toDateString().includes("Sat");if(a||o)return[!1];if(t){const a=t.find(t=>t.DataRoteiro.toLocaleDateString()===e.toLocaleDateString());if(a)return a.Disponivel?[!0]:[!1]}return[!1]}}),$("#input-cep-btn").click(d);const s=JSON.parse(localStorage.getItem("AG_AddressSelected"));function r(e){let t=e[0];if(t){let e=t.slas.find(e=>e.id.toLocaleLowerCase()==="Autoglass Móvel".toLocaleLowerCase());if(e){let t=+e.shippingEstimate.replace("bd",""),a=new Date;n.setDate(a.getDate()+t),i=new Date(n.getFullYear(),n.getMonth()+2,0),$("#mostrar-datas-datepicker").datepicker("option","maxDate",i),$("#mostrar-datas-datepicker").datepicker("option","minDate",n)}}}async function d(a){if($("#aviso-servico-movel").hide(),$(".preview-data").hide(),a&&!o){o=!0,$(".datas-disponiveis").show(),$(".loading-dates").show(),$("#mostrar-datas-datepicker").css("height","0px");const s={Cep:a,DataInicio:n.toISOString().split("T")[0],DataFim:i.toISOString().split("T")[0],Carrinho:[],TipoDocumento:"Venda",TipoServico:"Instalacao",Qt:100};if(window.skuJson)s.Carrinho.push({CodigoProduto:+window.skuJson.name.match(/\d+$/)[0],Quantidade:1});else{let e;e=window.location.href.includes("orderPlaced")?await new Promise((e,t)=>{$.ajax({jsonp:!1,url:"/api/checkout/pub/orders/"+$("#order-id").text().trim(),contentType:"application/json",type:"GET",success:function(t){e(t)},error:function(e){t(e)}})}):await vtexjs.checkout.getOrderForm(),s.Carrinho=e.items.filter(e=>"2000108"!==e.additionalInfo.brandId).map(e=>({CodigoProduto:+e.productRefId,Quantidade:1}))}try{const a=await function(t){return new Promise((a,o)=>{$.ajax({contentType:"application/json",crossDomain:!0,jsonp:!1,type:"POST",url:e+"agendamentos/servicos-moveis/disponibilidades",data:JSON.stringify(t),success:function(e){a(e)},error:function(e){o(e)}})})}(s);t=a.Registros.map(e=>({...e,DataRoteiro:new Date(e.DataRoteiro)})),a.Registros.filter(e=>!1===e.Disponivel).length===a.Registros.length?$("#aviso-servico-movel").show().html('\n              Instalação em Casa indisponível para sua região. Tente alterar o CEP ou\n              <a onclick="$zopim.livechat.window.show()"><b> clique aqui </b></a>\n              e fale com a gente pelo chat.\n            '):($("#mostrar-datas-datepicker").datepicker("setDate",n),$("#mostrar-datas-datepicker").datepicker("refresh"),$("a.ui-state-active").removeClass("ui-state-active"),$("a.ui-state-hover").removeClass("ui-state-hover"),$("#mostrar-datas-datepicker").css("height","270px"))}catch(e){let t;switch(e.status){case 400:t=JSON.parse(e.responseText).Message;break;default:t="Não encontramos atendimento para este CEP. Mas procure a gente no chat para te ajudar!"}$("#aviso-servico-movel").show().html(t)}finally{o=!1,$(".loading-dates").hide()}}}s?d(s.postalCode):$(window).on("cep-finish-load",e=>{const t=e.originalEvent.detail;r(t.shippingData.logisticsInfo),d(t.shippingData.address.postalCode)}),$(window).on("cep-updated",e=>{const t=e.originalEvent.detail;r(t.shippingData.logisticsInfo),d(t.shippingData.address.postalCode)}),window.dispatchEvent(a)}))}]);