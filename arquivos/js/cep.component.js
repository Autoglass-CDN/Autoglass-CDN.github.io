$(function(){const t={SELECTOR:'.cep:not(".link")',LOCAL_TO_RENDER_CEP:"data-render-cep",EVENTS:{FINISH_LOAD:"cep-finish-load",CEP_UPDATED:"cep-updated"},STORAGE:"AG_AddressSelected"},e=function(){return{init:async function(){const e=await o.getOrderForm();e.shippingData&&o.saveAddressOnLocalStorage(e.shippingData);$(t.SELECTOR).each(function(i,a){$(a).html("").addClass("ghost-loading");const c=$(a).attr(t.LOCAL_TO_RENDER_CEP);let s;a.id="cep"+i,$(c).css("position","relative"),$(c).css("overflow","hidden"),$(c).css("min-height","150px");let l=window.location.href.includes("/checkout"),r=+localStorage.getItem("ufDefinedByTop");!l&&r?s=null:e.shippingData&&(s=e.shippingData.address),n.renderCepInfo(a,c,s),$(window).on(t.EVENTS.CEP_UPDATED,async t=>{const e=t.originalEvent.detail;o.saveAddressOnLocalStorage(e.shippingData),$(a).html("").addClass("ghost-loading"),n.renderCepInfo(a,c,e.shippingData.address)}),$(window).on("orderFormUpdated.vtex",(t,e)=>{o.saveAddressOnLocalStorage(e.shippingData)})}),window.dispatchEvent(new CustomEvent(t.EVENTS.FINISH_LOAD,{detail:e}))},formatAddress:function(t){const{city:e,neighborhood:n,state:o,street:i,postalCode:a}=t;let c="";i&&(c+=i);n&&(i&&(c+=" - "),c+=n);e&&(n&&(c+=", "),c+=e);o&&(e&&(c+=" - "),c+=o);return c||a},submitEvent:async function(e,n){if(e.preventDefault(),!n)return void $(this).addClass("cep-new__content-form--error");$(".cep-new__content--loading").show().css("right","0");try{const[e]=await o.calculateShipping(n);$(".cep-new").css("transform","translateX(105%)"),localStorage.setItem("ufDefinedByTop",0),window.dispatchEvent(new CustomEvent(t.EVENTS.CEP_UPDATED,{detail:e})),setTimeout(()=>$(".cep-new").remove(),1e3)}catch(t){$(".cep-new__content--loading").hide().css("right","unset"),console.error(t)}}}}(),n=function(){return{renderCepInfo:function(n,o,i){if(i){const t=e.formatAddress(i);$(n).removeClass("ghost-loading").html(`\n\t\t\t\t\t\t<div class="cep-info">\n\t\t\t\t\t\t\t<div class="cep-info__location">\n\t\t\t\t\t\t\t\t<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-geo-alt" fill="currentColor"\n\t\t\t\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd"\n\t\t\t\t\t\t\t\t\t\td="M12.166 8.94C12.696 7.867 13 6.862 13 6A5 5 0 0 0 3 6c0 .862.305 1.867.834 2.94.524 1.062 1.234 2.12 1.96 3.07A31.481 31.481 0 0 0 8 14.58l.208-.22a31.493 31.493 0 0 0 1.998-2.35c.726-.95 1.436-2.008 1.96-3.07zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z" />\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd" d="M8 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span class="cep-info__location-street">${t}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button id="change-cep-button" class="cep-info__location-button">Alterar</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`)}else $(n).removeClass("ghost-loading").html('\n\t\t\t\t\t\t<div class="cep-info">\n\t\t\t\t\t\t\t<div class="cep-info__location">\n\t\t\t\t\t\t\t\t<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-geo-alt" fill="currentColor"\n\t\t\t\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd"\n\t\t\t\t\t\t\t\t\t\td="M12.166 8.94C12.696 7.867 13 6.862 13 6A5 5 0 0 0 3 6c0 .862.305 1.867.834 2.94.524 1.062 1.234 2.12 1.96 3.07A31.481 31.481 0 0 0 8 14.58l.208-.22a31.493 31.493 0 0 0 1.998-2.35c.726-.95 1.436-2.008 1.96-3.07zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z" />\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd" d="M8 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button id="change-cep-button" class="cep-info__location-button">Informe seu cep aqui</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t');if(+localStorage.getItem("locationChanged")){const t=$(`#${n.id}`);let e=t.html();e+='<span class="cep-info__location-changed">Região alterada conforme novo CEP informado.</span>',t.html(e)}$(`#${n.id} .cep-info__location-button`).click(()=>{o?function(t){$(t).append('\n\t\t\t\t<div class="cep-new">\n\t\t\t\t\t<div class="cep-new__content">\n\t\t\t\t\t\t<div class="cep-new__content--loading">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-geo-alt" fill="currentColor"\n\t\t\t\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd"\n\t\t\t\t\t\t\t\t\t\td="M12.166 8.94C12.696 7.867 13 6.862 13 6A5 5 0 0 0 3 6c0 .862.305 1.867.834 2.94.524 1.062 1.234 2.12 1.96 3.07A31.481 31.481 0 0 0 8 14.58l.208-.22a31.493 31.493 0 0 0 1.998-2.35c.726-.95 1.436-2.008 1.96-3.07zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10z" />\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd" d="M8 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 1a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-geo-alt-fill" fill="currentColor"\n\t\t\t\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd"\n\t\t\t\t\t\t\t\t\t\td="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class="cep-new__content-title">Informe seu CEP</span>\n\t\t\t\t\t\t<form class="cep-new__content-form">\n\t\t\t\t\t\t\t<input type="text" inputmode="numeric" autocomplete="off" id="cep-input" placeholder="00000-000" class="cep-new__content-input" />\n\t\t\t\t\t\t\t<button id="cep-new-button" type="submit" class="cep-new__content-button">\n\t\t\t\t\t\t\t\t<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-right-circle-fill" fill="currentColor"\n\t\t\t\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t\t\t<path fill-rule="evenodd"\n\t\t\t\t\t\t\t\t\t\td="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-11.5.5a.5.5 0 0 1 0-1h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5z" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="cep-new__footer">\n\t\t\t\t\t\t<button id="cep-back-button" type="button" class="cep-new__footer-back-button">Voltar</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t'),setTimeout(()=>$(".cep-new").css("transform","translateX(0)"),100);const n=function(){const t=window.innerWidth<1200;t?($("#cep-input").attr("placeholder","00000000"),$("#cep-input").attr("max-length","8")):($("#cep-input").attr("placeholder","00000-000"),$("#cep-input").attr("max-length","9"),$("#cep-input").mask("99999-999"));return t}(),o=n?8:9;$(`${t} #cep-back-button`).click(t=>{$(".cep-new").css("transform","translateX(-105%)"),setTimeout(()=>$(".cep-new").remove(),1e3)}),$("#cep-input").focus(),$("#cep-input").click(function(){n||$(this)[0].setSelectionRange(0,0)}),$("#cep-input").keyup(t=>{if(t.preventDefault(),t.target.value.replace("_","").length===o){const n=$("#cep-input").val();e.submitEvent(t,n)}}),$(".cep-new__content-form").on("submit",t=>{if(t.preventDefault(),$("#cep-input").val().replace("_","").length===o){const n=$("#cep-input").val();e.submitEvent(t,n)}})}(o):console.error(t.LOCAL_TO_RENDER_CEP+" não encontrado. Id: "+n.id)})}}}(),o=function(){return{calculateShipping:async function(t){const e=await vtexjs.checkout.calculateShipping({postalCode:t,country:"BRA",addressType:"search"}),n=await vtexjs.checkout.calculateShipping({postalCode:t,country:"BRA",addressType:"residential"});return[e,n]},getOrderForm:async function(){return await vtexjs.checkout.getOrderForm()},saveAddressOnLocalStorage:function(e){localStorage.setItem(t.STORAGE,JSON.stringify({...e.address,logisticsInfo:e.logisticsInfo}))}}}();e.init()});