!function(){window.vtexjs&&vtexjs.checkout?e():(console.warn("VTEXJS ainda n\xe3o carregado. Aguardando..."),window.addEventListener("load",e));function e(){$(window).on("orderFormUpdated.vtex",function(e,t){!function(e){async function t(){if(location.href.includes("checkout/orderPlaced")){let t=e("#order-id").text().trim(),r=(await fetch(`/api/checkout/pub/orders/${t}`,{headers:new Headers({"Content-Type":"application/json"})}).then(e=>e.json())).clientProfileData.email;r&&a(r,null,t)}}async function a(t,a=null,r=null){try{let o,n=await fetch(`https://api.autoglass.com.br/integracao-b2c/api/web-app/master-datas/clientes/${t.trim()}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({Hubspotutk:function t(){try{return e.cookie("hubspotutk")}catch(a){return null}}(),LastOrderFormId:a||function e(){try{return vtexjs.checkout.orderForm.orderFormId}catch(t){return null}}(),LastOrderId:r})});n.ok?console.log("Dados enviados com sucesso ao MasterData."):console.error("Erro ao enviar dados ao MasterData:",n.status,n.statusText)}catch(i){console.error("Erro ao enviar dados ao MasterData:",i)}}e(window).on("rendered.vtexid",function e(t){let r=document.querySelector("#vtexIdUI-form-classic-login #inputEmail");document.getElementById("vtexIdUI-form-classic-login").addEventListener("submit",e=>{let t=r.value;t&&a(t)})}),e(window).on("checkoutRequestEnd.vtex",function e(t,r){try{let o=vtexjs.checkout.orderForm,n="",i=null;if(r&&r.clientProfileData?(n=r.clientProfileData.email,i=r.orderFormId):o.clientProfileData&&o.clientProfileData.email&&(n=o.clientProfileData.email,i=o.orderFormId),!n){(function e(){if(location.href.includes("checkout/#/email")){let t=document.querySelector("#client-profile-data form.client-pre-email"),r=document.querySelector("form.client-pre-email input#client-pre-email");t.addEventListener("submit",e=>{let t=r.value;t&&a(t)})}})();return}a(n,i)}catch(l){console.warn("Falha ao obter e-mail para enviar o Hubspotutk ao MasterData!")}}),e(window).on("load",t)}(window.jQueryNew||window.jQuery)})}}();