!function(e){async function t(){if(location.href.includes("checkout/orderPlaced")){let t=e("#order-id").text().trim(),a=(await fetch(`/api/checkout/pub/orders/${t}`,{headers:new Headers({"Content-Type":"application/json"})}).then(e=>e.json())).clientProfileData.email;a&&r(a,null,t)}}async function r(t,r=null,a=null){try{let o=await fetch(`https://api.autoglass.com.br/integracao-b2c/api/web-app/master-datas/clientes/${t.trim()}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({Hubspotutk:function t(){try{return e.cookie("hubspotutk")}catch(r){return null}}(),LastOrderFormId:r||function e(){try{return vtexjs.checkout.orderForm.orderFormId}catch(t){return null}}(),LastOrderId:a})});o.ok?console.log("Dados enviados com sucesso ao MasterData."):console.error("Erro ao enviar dados ao MasterData:",o.status,o.statusText)}catch(n){console.error("Erro ao enviar dados ao MasterData:",n)}}e(window).on("rendered.vtexid",function e(t){let a=document.querySelector("#vtexIdUI-form-classic-login #inputEmail");document.getElementById("vtexIdUI-form-classic-login").addEventListener("submit",e=>{let t=a.value;t&&r(t)})}),e(window).on("checkoutRequestEnd.vtex",function e(t,a){try{let o=vtexjs.checkout.orderForm,n="",i=null;if(a&&a.clientProfileData?(n=a.clientProfileData.email,i=a.orderFormId):o.clientProfileData&&o.clientProfileData.email&&(n=o.clientProfileData.email,i=o.orderFormId),!n){(function e(){if(location.href.includes("checkout/#/email")){let t=document.querySelector("#client-profile-data form.client-pre-email"),a=document.querySelector("form.client-pre-email input#client-pre-email");t.addEventListener("submit",e=>{let t=a.value;t&&r(t)})}})();return}r(n,i)}catch(l){console.warn("Falha ao obter e-mail para enviar o Hubspotutk ao MasterData!")}}),e(window).on("load",t)}(window.jQueryNew||window.jQuery);