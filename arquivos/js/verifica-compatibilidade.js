!function(e){window.addEventListener("load",()=>{function e(){document.querySelectorAll(".pages li.page-number").forEach(e=>{e.setAttribute("href",`?${e.textContent.trim()}`)}),console.log("Atributo href atualizado nos elementos de pagina\xe7\xe3o.")}let t;(t=document.querySelector(".pager.bottom"))?(new MutationObserver(t=>{t.forEach(t=>{"childList"===t.type&&e()})}).observe(t,{childList:!0,subtree:!0}),e()):console.log("Container de pagina\xe7\xe3o n\xe3o encontrado.");let o=!1,a=document.querySelector(".compat-header");a.addEventListener("click",function e(){let t=document.getElementById("compatContent"),i=document.querySelector(".icon-arrow-down"),r=document.querySelector(".icon-arrow-up");(o=!o)?(t.style.display="block",i.style.display="none",r.style.display="block",window.Cloudflare_Turnstile.render("#cf-turnstile-compat"),window.Cloudflare_Turnstile.reset("#cf-turnstile-compat")):(t.style.display="none",a.style.paddingBottom="",i.style.display="block",r.style.display="none")})});let t={MONTADORA:36,VEICULO:50,ANO:48,FIPE:76},o={ORIGIN:location.origin,ASYNC:{TREE_LEVEL:2}},a=/^[A-Z]{3}[\-_]?[0-9][0-9A-Z][0-9]{2}$/i,i=document.getElementById("icon-question"),r=document.getElementById("tooltip-question"),l=document.querySelector("#botaoProdutosCompativeis");function c(e,t=[]){let o="",a=[];if(e){e.startsWith("/")||(e="/"+e),e.endsWith("/")&&(e=e.slice(0,-1));let i=e.split("/").filter(Boolean);o+="/"+i.map(encodeURIComponent).join("/"),a.push(...i.map(()=>"c"))}return t.forEach(e=>{e?.value&&e?.codigo&&(o+=`/${encodeURIComponent(e.value)}`,a.push(`specificationFilter_${e.codigo}`))}),`${o}?PS=24&map=${a.join(",")}`}async function n(e,o,i=""){var r,l,n,d,y,f;if(!(""!==(r=e)&&r.trim().match(a))&&(s(),1))return;let v=document.getElementById("overlayCompat");v.classList.remove("hidden");try{let g,S,C,h,b,E,{montadora:x,modelo:$,anoModelo:L,fipe:I}=await u(e.trim().replace(/[\W_]+/g,"").toUpperCase()),[q,A,V,k]=await Promise.all([p({filtro:t.MONTADORA,regex:(l=x,RegExp(l.split(" ").join("|"),"gi"))}),p({filtro:t.VEICULO,regex:(n=x,d=$,g=n.split(" ").filter(e=>RegExp(/[^\W_]+/,"gi").test(e)),C=(S=function e(t,o){switch(!0){case"NEW CLASSIC"===t:return"CLASSIC";case"UP"===t:case"CROSS UP!"===t:return"Up!";case"FH 520"===t:return"FH 520";case RegExp(/^FH (12 )?\d{3}$/i).test(t):return"FH 12 Globetroter";case RegExp(/^FH 16 \d{3}$/i).test(t):return"FH 16 Globetroter";case RegExp(/^NH 12 \d{3}$/i).test(t):return"NH 12";case RegExp(/^NH 10 \d{3}$/i).test(t):return"NH 10";case"XC70"===t:return"S40";case"E-DELIVERY"===t:return"DELIVERY";case"POLO CLASSIC"===t:return"Polo Sedan";case"SS10"===t:return"S10";case"TTS"===t:return"TT";case RegExp(/^[A-Z]-CLASS$/i).test(t):return"Classe "+t.replace(/-CLASS/gi,"");default:return t.replace(RegExp(o.join(" "),"gi"),"").trim()}}(d,g)).replace(/[\W]+/gi,""),h=`(${g.join("|")})`,b=`(${S}|${C})`,E=`^${b}$|${h} ${b}$`,RegExp(E,"gi"))}),p({filtro:t.ANO,regex:(y=L,RegExp(y.trim(),"gi"))}),I?p({filtro:t.FIPE,regex:(f=I,RegExp(f.replace(/(\d+)(\d)$/,"0$1-$2"),"i"))}):[],]),w=[{value:k[0]?.Value,codigo:t.FIPE},{value:V[0]?.Value,codigo:t.ANO},{value:A[0]?.Value,codigo:t.VEICULO},{value:q[0]?.Value,codigo:t.MONTADORA},],O=c("",w);if("verificarCompatibilidade"===o){let _=await m(O),N=skuJson?.productId||window.vtex?.product?.id,P=_.some(e=>e.productId==N);s(P,P?"sucesso":"erro")}else if("produtoCompativel"===o){let D=i?.trim()||"";D&&!D.startsWith("/")&&(D="/"+D),D.endsWith("/")&&(D=D.slice(0,-1));let T=c(D,w);window.location.href=T}}catch(B){console.error("Erro ao tratar compatibilidade:",B);let F=B&&B.message?String(B.message):"",R=B?.httpStatus===400||B?.httpStatus===401||B?.httpStatus===403||B?.httpStatus===503||F.includes("Valida\xe7\xe3o anti-bot")||F.includes("Turnstile")||F.includes("verificador Turnstile");if(R){alert(F||"Valida\xe7\xe3o anti-bot ausente ou inv\xe1lida.");return}if(F.includes("Placa n\xe3o encontrada")||B instanceof VehicleNotFoundException){EstilizarCardCompatibilidade();return}alert(F||"Erro ao verificar compatibilidade. Tente novamente.")}finally{v.classList.add("hidden")}}function s(e,t){document.querySelector("#icon-verificar-compatibilidade-check").style.display="none",document.querySelector("#icon-verificar-compatibilidade-xmark").style.display="none",document.querySelector("#icon-question").style.display="none",document.querySelector("#botaoVerificarCompatibilidade").textContent="Nova Consulta",e&&"sucesso"===t?d({titulo:"Produto compat\xedvel com seu ve\xedculo",cor:"#44C15D",descricao:"Se desejar, voc\xea pode verificar outra placa clicando em nova consulta.",icones:["check"]}):e||"erro"!==t?d({titulo:"N\xe3o sabemos se \xe9 compat\xedvel",cor:"#C89C00",descricao:"Por favor, verifique a lista de ve\xedculos compat\xedveis para esse produto ou voc\xea pode realizar uma nova consulta.",icones:["check","question"]}):d({titulo:"Produto incompat\xedvel com seu ve\xedculo",cor:"#d93025",descricao:"Voc\xea pode realizar uma nova busca ou verificar outra placa clicando em nova consulta.",icones:["xmark"]})}function d(e){let t=document.querySelector(".title-text"),o=document.querySelector(".compat-description"),a=document.querySelector(".compat-box"),i=document.querySelector("#placaInput");if(t.textContent=e.titulo,t.style.color=e.cor,o.textContent=e.descricao,a.style.borderColor=e.cor,i.style.borderColor=e.cor,e.icones.includes("check")){let r=document.querySelector("#icon-verificar-compatibilidade-check");r.style.display="block",r.style.color=e.cor}e.icones.includes("xmark")&&(document.querySelector("#icon-verificar-compatibilidade-xmark").style.display="block",l.style.display="block"),e.icones.includes("question")&&(document.querySelector("#icon-question").style.display="block",l.style.display="none")}async function u(){let e=await window.Cloudflare_Turnstile.obterVeiculo({placa,containerSelector:"#compatContent",containerForRender:"#cf-turnstile-compat"});if(e?.Message?.includes("Placa \xe9 obrigat\xf3rio"))throw s(),Error("Placa n\xe3o encontrada");let t=e.Body.Data.Marca,o=e.Body.Data.Modelo,a=e.Body.Data.DadosBasicosDoVeiculo.AnoModelo,i=e.Body.Data.DadosBasicosDoVeiculo.InformacoesFipe?.[0]?.FipeId,r=[{montadora:t,modelo:o,anoModelo:a,fipe:i,timestamp:new Date().toLocaleString()},];return localStorage.setItem("infoBuscaPLaca",JSON.stringify(r)),{montadora:t,modelo:o,anoModelo:a,fipe:i}}async function p({filtro:e,regex:t}){return(await (await fetch(`${o.ORIGIN}/api/catalog_system/pub/specification/fieldValue/${e}`)).json()).filter(e=>t.test(e.Value))}async function m(e){let t=[],o=0;for(;;){let a=await (await fetch(`/api/catalog_system/pub/products/search${e}&_from=${o}&_to=${o+50-1}`)).json();if(t.push(...a),a.length<50||(o+=50)>1e3)break}return t}async function y(){return await e.get(`${o.ORIGIN}/api/catalog_system/pub/category/tree/${o.ASYNC.TREE_LEVEL}`)}window.addEventListener("DOMContentLoaded",function(){let e=document.querySelector("#botaoVerificarCompatibilidade");e&&e.addEventListener("click",function(){n(document.getElementById("placaInput").value,"verificarCompatibilidade")})}),i.addEventListener("mouseenter",()=>{r.classList.remove("hidden")}),i.addEventListener("mouseleave",()=>{r.classList.add("hidden")}),l.addEventListener("click",async()=>{let e="",t=await y(),o=[],a=[];t.filter(e=>e.hasChildren).forEach(e=>{o.push(...e.children)}),o.forEach(e=>{a.push(...e.children)});let i=a.find(e=>e.id===window.dataLayer[0].productCategoryId);e=i.url?i.url.replace(new URL(i.url).origin,""):"/"+i.name.toLowerCase(),n(document.getElementById("placaInput").value,"produtoCompativel",e)})}(jQueryNew);